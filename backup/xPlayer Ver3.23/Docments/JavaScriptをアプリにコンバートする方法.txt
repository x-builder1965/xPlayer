Electronã§ã€ŒxPlayer -å‹•ç”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼-ã€ã‚’Windowsã‚¢ãƒ—ãƒªåŒ–ã™ã‚‹æ‰‹é †

1. ç’°å¢ƒæº–å‚™
    Node.jsã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š
        Node.js LTSï¼ˆv18.xã¾ãŸã¯v20.xï¼‰ã‚’https://nodejs.org/ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚
        ç¢ºèªï¼šnode -v, npm -vï¼ˆnpm v8.xä»¥ä¸Šæ¨å¥¨ï¼‰ã€‚
    
    ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆï¼š
        ä¾‹ï¼šH:\Workspace\JavaApp\xPlayer-appã€‚
        ã‚³ãƒãƒ³ãƒ‰ï¼šmkdir xPlayer-app && cd xPlayer-appã€‚
    
    Node.jsãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’åˆæœŸåŒ–ï¼š
        npm init -yã§package.jsonã‚’ä½œæˆã€‚
    
    Electronã¨electron-builderã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼š
        ã‚³ãƒãƒ³ãƒ‰ï¼šnpm install electron@38.4.0 electron-builder@26.0.12 --save-devã€‚
        ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆä¾‹ï¼šECONNRESETï¼‰ãŒç™ºç”Ÿã—ãŸå ´åˆï¼š
            ãƒ¬ã‚¸ã‚¹ãƒˆãƒªå¤‰æ›´ï¼šnpm config set registry https://registry.npmmirror.com/ã€‚
            ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ï¼šnpm cache clean --forceã€‚
            ãƒ—ãƒ­ã‚­ã‚·ç¢ºèªï¼šnpm config get proxy, npm config get https-proxyã€‚
    
    ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’æº–å‚™ï¼š
    ------------------------------------------------------------------------------------------
    xPlayer-app/
    â”œâ”€â”€ main.js
    â”œâ”€â”€ index.html
    â”œâ”€â”€ xPlayer.ico
    â”œâ”€â”€ package.json
    â””â”€â”€ node_modules/
    ------------------------------------------------------------------------------------------
    
    index.htmlï¼šæä¾›ã•ã‚ŒãŸã€ŒxPlayer -å‹•ç”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼-.htmlã€ã‚’ã‚³ãƒ”ãƒ¼ã€‚
    xPlayer.icoï¼š256x256ãƒ”ã‚¯ã‚»ãƒ«ä»¥ä¸Šã®ICOãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆè¤‡æ•°ã‚µã‚¤ã‚ºï¼š16x16ã€32x32ã€64x64ã€128x128ã€256x256æ¨å¥¨ï¼‰ã€‚
        å¤‰æ›ãƒ„ãƒ¼ãƒ«ï¼š
            Convertioï¼ˆhttps://convertio.co/ja/png-ico/ï¼‰
            ã¾ãŸã¯
            ImageMagickï¼ˆ`magick convert xPlayer.png -resize 256x256 xPlayer.ico`ï¼‰ã€‚

2. package.jsonã®è¨­å®špackage.jsonã®å†…å®¹ï¼š
    json
    ------------------------------------------------------------------------------------------
    {
        "name": "xplayer",
        "version": "1.59.0",
        "description": "xPlayer - Video Player",
        "main": "main.js",
        "scripts": {
            "start": "electron .",
            "build": "electron-builder --win nsis"
        },
        "author": "x-builder",
        "license": "MIT",
        "devDependencies": {
            "electron": "^38.4.0",
            "electron-builder": "^26.0.12"
        },
        "build": {
            "appId": "com.xbuilder.xplayer",
            "productName": "xPlayer",
            "files": [
                "main.js",
                "index.html",
                "xPlayer.ico"
            ],
            "win": {
                "icon": "xPlayer.ico",
                "target": ["nsis"],
                "asarUnpack": ["**\\*.{node,dll}"],
                "extraResources": ["node_modules/7zip-bin/**"]
            },
            "nsis": {
                "oneClick": false,
                "allowToChangeInstallationDirectory": true,
                "createDesktopShortcut": true,
                "createStartMenuShortcut": true,
                "shortcutName": "xPlayer",
                "installerLanguages": ["ja_JP"]
            }
        }
    }
    ------------------------------------------------------------------------------------------
    
    ãƒã‚¤ãƒ³ãƒˆï¼š
        build.win.iconï¼š256x256ãƒ”ã‚¯ã‚»ãƒ«ã®xPlayer.icoã‚’æŒ‡å®šï¼ˆã‚¢ã‚¤ã‚³ãƒ³ã‚¨ãƒ©ãƒ¼å›é¿ï¼‰ã€‚
        asarUnpackã¨extraResourcesï¼šã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆlibcrypto.dylib, libssl.dylibï¼‰ã‚’å›é¿ã€‚
        scripts.buildï¼šWindows NSISãƒ“ãƒ«ãƒ‰ã‚’æ˜ç¤ºã€‚
        JSONæ§‹æ–‡ã‚’ç¢ºèªï¼ˆEJSONPARSEå›é¿ï¼‰ã€‚
    
3. ãƒ¡ã‚¤ãƒ³ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆmain.jsï¼‰ã®ä½œæˆ
    main.jsã®å†…å®¹ï¼š
    javascript
    ------------------------------------------------------------------------------------------
    const { app, BrowserWindow, dialog, ipcMain } = require('electron');
    const path = require('path');
    
    function createWindow() {
        const win = new BrowserWindow({
            width: 1280,
            height: 720,
            webPreferences: {
                nodeIntegration: false,
                contextIsolation: true,
                preload: path.join(__dirname, 'preload.js'),
                webSecurity: false
            },
            icon: path.join(__dirname, 'xPlayer.ico')
        });
        win.loadFile('index.html');
        win.maximize();
    }
    
    app.whenReady().then(() => {
        createWindow();
        app.on('activate', () => {
            if (BrowserWindow.getAllWindows().length === 0) createWindow();
        });
    });
    
    app.on('window-all-closed', () => {
        if (process.platform !== 'darwin') app.quit();
    });
    
    ipcMain.handle('open-folder-dialog', async () => {
        const result = await dialog.showOpenDialog({ properties: ['openDirectory'] });
        if (!result.canceled && result.filePaths.length > 0) {
            const fs = require('fs').promises;
            const folderPath = result.filePaths[0];
            const files = await fs.readdir(folderPath);
            return files
                .filter(file => /\.(mp4|mkv|webm)$/i.test(file))
                .map(file => ({ name: file, path: path.join(folderPath, file) }));
        }
        return [];
    });
    
    ipcMain.handle('open-video-dialog', async () => {
        const result = await dialog.showOpenDialog({
            properties: ['openFile'],
            filters: [{ name: 'Videos', extensions: ['mp4', 'mkv', 'webm'] }]
        });
        if (!result.canceled && result.filePaths.length > 0) {
            return [{ name: path.basename(result.filePaths[0]), path: result.filePaths[0] }];
        }
        return [];
    });
    ------------------------------------------------------------------------------------------
    
    ãƒã‚¤ãƒ³ãƒˆï¼š
        nodeIntegration: false, contextIsolation: trueã§ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–ã€‚
        webSecurity: falseã§ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã€‚
        dialogãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã§ãƒ•ã‚©ãƒ«ãƒ€/ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚’å®Ÿè£…ã€‚

4. ãƒ—ãƒªãƒ­ãƒ¼ãƒ‰ã‚¹ã‚¯ãƒªãƒ—ãƒˆï¼ˆpreload.jsï¼‰ã®ä½œæˆ
    preload.jsã®å†…å®¹ï¼š
    javascript
    ------------------------------------------------------------------------------------------
    const { contextBridge, ipcRenderer } = require('electron');
    contextBridge.exposeInMainWorld('electronAPI', {
        openFolderDialog: () => ipcRenderer.invoke('open-folder-dialog'),
        openVideoDialog: () => ipcRenderer.invoke('open-video-dialog')
    });
    ------------------------------------------------------------------------------------------
    
    é…ç½®ï¼šxPlayer-app/preload.jsã«ä¿å­˜ã€‚

5. index.htmlã®èª¿æ•´
    ã‚¢ã‚¤ã‚³ãƒ³ã‚’ICOã«å¤‰æ›´ï¼š
    html
    ------------------------------------------------------------------------------------------
    <link rel="icon" type="image/x-icon" href="xPlayer.ico">
    ------------------------------------------------------------------------------------------
    
    JavaScriptã‚’ä¿®æ­£ï¼ˆ<script>å†…ï¼‰ï¼š
    javascript
    ------------------------------------------------------------------------------------------
    const { openFolderDialog, openVideoDialog } = window.electronAPI;
    
    folderInput.addEventListener('click', async () => {
        folderInput.classList.remove('resume-active');
        videoInput.classList.remove('resume-active');
        hideOverlayDisplay();
        const files = await openFolderDialog();
        if (files.length > 0) {
            playlist = files.map(file => ({ file: { name: file.name, path: file.path }, name: file.name }));
            playlist.sort((a, b) => a.name.localeCompare(b.name));
            const savedPlaylist = localStorage.getItem('playlist');
            const playlistNames = playlist.map(item => item.name);
            const matchesSavedPlaylist = savedPlaylist && JSON.stringify(playlistNames) === savedPlaylist;
            if (matchesSavedPlaylist && savedCurrentVideoIndex) {
                currentVideoIndex = Math.min(parseInt(savedCurrentVideoIndex), playlist.length - 1);
            } else {
                currentVideoIndex = 0;
                localStorage.setItem('currentTime', 0);
            }
            updatePlaylistDisplay();
            playVideo(playlist[currentVideoIndex].file);
        } else {
            updatePlaylistDisplay();
            stopPeriodicSave();
            savePlaylistAndPlaybackState();
        }
    });
    
    videoInput.addEventListener('click', async () => {
        folderInput.classList.remove('resume-active');
        videoInput.classList.remove('resume-active');
        hideOverlayDisplay();
        const files = await openVideoDialog();
        if (files.length > 0) {
            playlist = files.map(file => ({ file: { name: file.name, path: file.path }, name: file.name }));
            const savedPlaylist = localStorage.getItem('playlist');
            let matchesSavedPlaylist = false;
            if (savedPlaylist) {
                try {
                    const parsedSavedPlaylist = JSON.parse(savedPlaylist);
                    matchesSavedPlaylist = parsedSavedPlaylist.length === 1 && parsedSavedPlaylist[0] === files[0].name;
                } catch (e) {
                    console.error('ä¿å­˜ã•ã‚ŒãŸãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®è§£æã«å¤±æ•—:', e);
                }
            }
            if (matchesSavedPlaylist && savedCurrentVideoIndex) {
                currentVideoIndex = parseInt(savedCurrentVideoIndex) || 0;
            } else {
                currentVideoIndex = 0;
                localStorage.setItem('currentTime', 0);
            }
            updatePlaylistDisplay();
            playVideo(files[0]);
        }
    });
    
    function playVideo(file) {
        video.src = file.path;
        updatePlaylistDisplay();
        const savedVolume = localStorage.getItem('volume');
        if (savedVolume && !isNaN(savedVolume) && savedVolume >= 0 && savedVolume <= 1) {
            video.volume = savedVolume;
            volumeBar.value = savedVolume;
            lastVolume = savedVolume;
            volumeMuteBtn.textContent = savedVolume == 0 ? 'ğŸ”‡' : 'ğŸ”Š';
            volumeMuteBtn.setAttribute('data-tooltip', savedVolume == 0 ? 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤' : 'ãƒŸãƒ¥ãƒ¼ãƒˆ');
        } else {
            video.volume = volumeBar.value || 0.2;
            lastVolume = video.volume;
            volumeMuteBtn.textContent = 'ğŸ”Š';
            volumeMuteBtn.setAttribute('data-tooltip', 'ãƒŸãƒ¥ãƒ¼ãƒˆ');
        }
        updateVolumeDisplay();
        video.load();
        showControlsAndFilename();
    }
    ------------------------------------------------------------------------------------------
    
    ãƒã‚¤ãƒ³ãƒˆï¼š
        window.electronAPIã§ãƒ¡ã‚¤ãƒ³ãƒ—ãƒ­ã‚»ã‚¹ã¨é€šä¿¡ã€‚
        URL.createObjectURLã‚’å»ƒæ­¢ã—ã€ãƒ­ãƒ¼ã‚«ãƒ«ãƒ‘ã‚¹ï¼ˆfile.pathï¼‰ã‚’ä½¿ç”¨ã€‚

6. ã‚¢ãƒ—ãƒªã®ãƒ†ã‚¹ãƒˆ
    èµ·å‹•ç¢ºèªï¼š
        ã‚³ãƒãƒ³ãƒ‰ï¼šnpm startã€‚
        Electronã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§å‹•ç”»å†ç”Ÿã€ãƒ•ã‚©ãƒ«ãƒ€/ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã€ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã€å†ç”Ÿä½ç½®ä¿å­˜ã‚’ç¢ºèªã€‚
    
    ãƒ‡ãƒãƒƒã‚°ï¼š
        main.jsã«win.webContents.openDevTools()ã‚’è¿½åŠ ï¼ˆå¿…è¦æ™‚ï¼‰ã€‚
        ã‚¨ãƒ©ãƒ¼ã‚„ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼ã‚’ç¢ºèªã€‚

7. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ã®ãƒ“ãƒ«ãƒ‰
    ãƒ“ãƒ«ãƒ‰æº–å‚™ï¼š
        ãƒ‡ã‚£ã‚¹ã‚¯å®¹é‡ç¢ºèªï¼šdir H:\ã€‚
        æ›¸ãè¾¼ã¿æ¨©é™ç¢ºèªï¼šicacls H:\Workspace\JavaApp\xPlayer-appã€‚
        ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ï¼šrmdir /s /q C:\Users\tsuyo\AppData\Local\electron-builder\Cacheã€‚
    
        NSISãƒ„ãƒ¼ãƒ«ã®ç¢ºèªï¼šNSISã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼ˆhttps://nsis.sourceforge.io/ï¼‰ã€‚
        ç’°å¢ƒå¤‰æ•°PATHã«è¿½åŠ ï¼šsetx PATH "%PATH%;C:\Program Files (x86)\NSIS"ã€‚
    
    ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œï¼š
        ç®¡ç†è€…æ¨©é™ã®PowerShellã§å®Ÿè¡Œï¼š
        bash
        ------------------------------------------------------------------------------------------
        cd H:\Workspace\JavaApp\xPlayer-app
        npm run build
        ------------------------------------------------------------------------------------------
    
        æˆåŠŸã™ã‚‹ã¨ã€dist/xPlayer-1.59.0.exeï¼ˆNSISã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ï¼‰ãŒç”Ÿæˆã€‚
    
    ã‚¨ãƒ©ãƒ¼å¯¾å¿œï¼š
        ã‚¢ã‚¤ã‚³ãƒ³ã‚¨ãƒ©ãƒ¼ï¼ˆimage must be at least 256x256ï¼‰ï¼šxPlayer.icoãŒ256x256ãƒ”ã‚¯ã‚»ãƒ«ä»¥ä¸Šã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚
        
        ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆCannot create symbolic linkï¼‰ï¼š
            ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œã€‚
            winCodeSignã‚’æ‰‹å‹•ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼š
            bash
            ------------------------------------------------------------------------------------------
            mkdir C:\Users\tsuyo\AppData\Local\electron-builder\Cache\winCodeSign
            REM ãƒ–ãƒ©ã‚¦ã‚¶ã§ https://github.com/electron-userland/electron-builder-binaries/releases/download/winCodeSign-2.6.0/winCodeSign-2.6.0.7z ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰
            copy winCodeSign-2.6.0.7z C:\Users\tsuyo\AppData\Local\electron-builder\Cache\winCodeSign\
            "H:\Workspace\JavaApp\xPlayer-app\node_modules\7zip-bin\win\x64\7za.exe" x -snld -bd "C:\Users\tsuyo\AppData\Local\electron-builder\Cache\winCodeSign\winCodeSign-2.6.0.7z" -o"C:\Users\tsuyo\AppData\Local\electron-builder\Cache\winCodeSign\winCodeSign-2.6.0"
            ------------------------------------------------------------------------------------------
    
    ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼ï¼ˆECONNRESETï¼‰ï¼š
        ãƒ¬ã‚¸ã‚¹ãƒˆãƒªå¤‰æ›´ã‚„ãƒ—ãƒ­ã‚­ã‚·è¨­å®šã‚’å†ç¢ºèªã€‚
        
        ç”Ÿæˆç‰©ç¢ºèªï¼šdist/xPlayer-1.59.0.exeã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€å‹•ä½œç¢ºèªã€‚

8. è¿½åŠ ã®æœ€é©åŒ–
    ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ï¼š
        nodeIntegration: false, contextIsolation: trueã‚’ç¶­æŒã€‚
    
    ãƒ“ãƒ«ãƒ‰ã‚µã‚¤ã‚ºå‰Šæ¸›ï¼š
        build.filesã«"!node_modules/**/*"ã‚’è¿½åŠ ã€‚
    
    ç½²åï¼š
        è¨¼æ˜æ›¸ã‚’è³¼å…¥ã—ã€build.win.certificateFileã‚’è¨­å®šï¼š
        json
        ------------------------------------------------------------------------------------------
        "win": {
            "certificateFile": "path/to/certificate.pfx",
            "certificatePassword": "your-password"
        }
        ------------------------------------------------------------------------------------------

    è‡ªå‹•æ›´æ–°ï¼š
        build.publishã‚’è¨­å®šï¼š
        json
        ------------------------------------------------------------------------------------------
        "publish": [
            { "provider": "generic", "url": "https://your-server.com/releases" }
        ]
        ------------------------------------------------------------------------------------------

9. æ³¨æ„ç‚¹
    ã‚¢ã‚¤ã‚³ãƒ³ï¼šxPlayer.icoã¯256x256ãƒ”ã‚¯ã‚»ãƒ«ä»¥ä¸Šã€è¤‡æ•°ã‚µã‚¤ã‚ºæ¨å¥¨ã€‚
    æ¨©é™ï¼šãƒ“ãƒ«ãƒ‰ã¯ç®¡ç†è€…æ¨©é™ã§å®Ÿè¡Œï¼ˆUACã‚¨ãƒ©ãƒ¼å›é¿ï¼‰ã€‚
    ãƒ­ã‚°ç¢ºèªï¼š
        ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã€dist/builder-debug.ymlã‚„C:\Users\tsuyo\AppData\Local\npm-cache\_logs\ã‚’ç¢ºèªã€‚
    å‹•ç”»ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼šMP4ã€MKVã€WebMã®ã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ï¼ˆH.264ã€VP9ï¼‰ãŒWindowsã§ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã€‚


=============================================================================================================
ã€å®Ÿè¡Œä¾‹ã€‘
äº‹å‰äº‹é …
    ãƒ»Node.jsãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã€‚ï¼ˆNode.jsã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§mpnã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆï¼‰

----------------------------------------------------------------------------------
0.ã‚³ãƒãƒ³ãƒ‰ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆï¼ˆç®¡ç†è€…æ¨©é™ï¼‰èµ·å‹•
----------------------------------------------------------------------------------
Microsoft Windows [Version 10.0.26200.6901]
(c) Microsoft Corporation. All rights reserved.

----------------------------------------------------------------------------------
1.ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚©ãƒ«ãƒ€ã®ä½œæˆãƒ»ç§»å‹•
----------------------------------------------------------------------------------
C:\Windows\System32>h:

H:\>mkdir H:\Workspace\JavaApp\xPlayer-app
H:\>cd H:\Workspace\JavaApp\xPlayer-app

----------------------------------------------------------------------------------
2.package.jsonä½œæˆ
----------------------------------------------------------------------------------
H:\Workspace\JavaApp\xPlayer-app>npm init -y
Wrote to H:\Workspace\JavaApp\xPlayer-app\package.json:

{
  "name": "xclock-app",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "keywords": [],
  "author": "",
  "license": "ISC"
}
----------------------------------------------------------------------------------
3.package.jsonç·¨é›†
4.ç’°å¢ƒæ§‹ç¯‰
----------------------------------------------------------------------------------
H:\Workspace\JavaApp\xPlayer-app>npm install electron@38.4.0 electron-builder@26.0.12 --save-dev
npm warn skipping integrity check for git dependency ssh://git@github.com/electron/node-gyp.git
npm warn deprecated inflight@1.0.6: This module is not supported, and leaks memory. Do not use it. Check out lru-cache if you want a good and tested way to coalesce async requests by a key value, which is much more comprehensive and powerful.
npm warn deprecated @npmcli/move-file@2.0.1: This functionality has been moved to @npmcli/fs
npm warn deprecated lodash.get@4.4.2: This package is deprecated. Use the optional chaining (?.) operator instead.
npm warn deprecated rimraf@2.6.3: Rimraf versions prior to v4 are no longer supported
npm warn deprecated rimraf@3.0.2: Rimraf versions prior to v4 are no longer supported
npm warn deprecated glob@7.2.3: Glob versions prior to v9 are no longer supported
npm warn deprecated glob@8.1.0: Glob versions prior to v9 are no longer supported
npm warn deprecated glob@8.1.0: Glob versions prior to v9 are no longer supported
npm warn deprecated boolean@3.2.0: Package no longer supported. Contact Support at https://www.npmjs.com/support for more info.
npm warn deprecated electron-packager@17.1.2: Please use @electron/packager moving forward. There is no API change, just a package name change

added 441 packages, and audited 442 packages in 43s

72 packages are looking for funding
  run `npm fund` for details

found 0 vulnerabilities

H:\Workspace\JavaApp\xPlayer-app>
----------------------------------------------------------------------------------
5.xPlayer.htmlâ†’index.htmlã‚³ãƒ”ãƒ¼
6.main.jsä½œæˆ
7.xPlayer.icoã‚³ãƒ”ãƒ¼
8.ç’°å¢ƒç¢ºèªãƒ†ã‚¹ãƒˆ
----------------------------------------------------------------------------------
H:\Workspace\JavaApp\xPlayer-app>npm start

> xclock@1.21.0 start
> electron .

H:\Workspace\JavaApp\xPlayer-app>
----------------------------------------------------------------------------------
9.ãƒ“ãƒ«ãƒ‰å®Ÿè¡Œ
----------------------------------------------------------------------------------
H:\Workspace\JavaApp\xPlayer-app>npm run build

> xclock@1.21.0 build
> electron-builder

  â€¢ electron-builder  version=26.0.12 os=10.0.26200
  â€¢ loaded configuration  file=package.json ("build" field)
  â€¢ writing effective config  file=dist\builder-effective-config.yaml
  â€¢ executing @electron/rebuild  electronVersion=38.4.0 arch=x64 buildFromSource=false appDir=./
  â€¢ installing native dependencies  arch=x64
  â€¢ completed installing native dependencies
  â€¢ packaging       platform=win32 arch=x64 electron=38.4.0 appOutDir=dist\win-unpacked
  â€¢ updating asar integrity executable resource  executablePath=dist\win-unpacked\xPlayer.exe
  â€¢ signing with signtool.exe  path=dist\win-unpacked\xPlayer.exe
  â€¢ building        target=nsis file=dist\xPlayer Setup 1.21.0.exe archs=x64 oneClick=true perMachine=false
  â€¢ signing with signtool.exe  path=dist\win-unpacked\resources\elevate.exe
  â€¢ signing with signtool.exe  path=dist\__uninstaller-nsis-xclock.exe
  â€¢ signing with signtool.exe  path=dist\xPlayer Setup 1.21.0.exe
  â€¢ building block map  blockMapFile=dist\xPlayer Setup 1.21.0.exe.blockmap

H:\Workspace\JavaApp\xPlayer-app>
