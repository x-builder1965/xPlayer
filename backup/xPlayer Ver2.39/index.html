<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>xPlayer -å‹•ç”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼-</title>
    <link rel="icon" type="image/x-icon" href="xPlayer.ico">
    <style>
        body {
            font-family: Arial, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #1c2526;
            color: #ffffff;
            margin: 0;
            height: 100vh;
            overflow: hidden;
        }
        .video-container {
            width: 100vw;
            height: 100vh;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            cursor: auto;
            display: flex;
        }
        video {
            width: 100vw;
            height: 100vh;
            object-fit: contain;
            border: none;
        }
        /* ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‹•ç”»ï¼ˆãƒ¯ã‚¤ãƒ—ï¼‰ */
        #videoPreview {
            position: absolute;
            width: 180px;
            height: 100px;
            border: 2px solid #007bff;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(0, 123, 255, 0.6);
            pointer-events: none;
            z-index: 950;
            display: none;
            object-fit: contain;
            background: #000;
        }
        /* ãƒ“ãƒ‡ã‚ªæš—è»¢ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤ */
        #darkOverlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 800;
            pointer-events: none;
            display: none;
            transition: opacity 0.2s ease;
        }
        .filename,
        .controls {
            position: absolute;
            width: 90%;
            display: flex;
            flex-direction: column;
            gap: 10px;
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 8px;
            transition: opacity 0.3s ease;
            z-index: 900;
            /* pointer-events ã¯ JS ã§å‹•çš„ã«è¨­å®š */
        }
        .filename {
            top: 20px;
        }
        .controls {
            bottom: 20px;
        }
        .control-row {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .left-controls {
            display: flex;
            align-items: center;
            gap: 0.5vw;
            flex-wrap: wrap;
        }
        .filename-controls {
            display: flex; 
            align-items: center; 
            gap: 10px; 
            width: 100%;
        }
        .filename-menus {
            display: none; 
            gap: 10px; 
        }
        button {
            font-size: 16px;
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            min-width: 40px;
            position: relative;
        }
        button:hover {
            background-color: #0056b3;
        }
        input[type="range"] {
            flex: 1;
            accent-color: #007bff;
            height: 8px;
            background: #555;
            border-radius: 5px;
            outline: none;
            position: relative;
        }
        input[type="range"]:hover {
            accent-color: #ff0000;
        }
        input[type="range"]#volumeBar {
            flex: none;
            width: 10%;
        }
        #seekBar:hover,
        #volumeBar:hover {
            background: rgba(0, 123, 255, 0.2);
            cursor: pointer;
        }
        #seekBar::-webkit-slider-thumb,
        #volumeBar::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 16px;
            height: 16px;
            background: #007bff;
            border-radius: 50%;
            cursor: pointer;
        }
        #seekBar:hover::-webkit-slider-thumb,
        #volumeBar:hover::-webkit-slider-thumb {
            background: #ff0000;
            transform: scale(1.5);
        }
        #seekBar::-moz-range-thumb,
        #volumeBar::-moz-range-thumb {
            width: 16px;
            height: 16px;
            background: #007bff;
            border: none;
            border-radius: 50%;
            cursor: pointer;
        }
        #seekBar:hover::-moz-range-thumb,
        #volumeBar:hover::-moz-range-thumb {
            background: #ff0000;
            transform: scale(1.5);
        }
        input[type="file"] {
            display: none;
        }
        input#urlInput {
            background: rgba(0, 0, 0, 0.5);
            color: #ffffff;
            border: 1px solid #007bff;
            border-radius: 5px;
            padding: 6px 12px;
            font-size: 16px;
            width: 90%;
            display: none;
        }
        select#filenameDisplay,
        select#sizeSelect {
            background: rgba(0, 0, 0, 0.5);
            color: #ffffff;
            border: 1px solid #007bff;
            border-radius: 5px;
            padding: 6px 12px;
            font-size: 16px;
            box-sizing: border-box;
            cursor: pointer;
            position: relative;
        }
        select#filenameDisplay {
            width: 100%;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        select#sizeSelect {
            width: 100px;
        }
        select#filenameDisplay option,
        select#sizeSelect option {
            background: #1c2526;
            color: #ffffff;
        }
        #timeDisplay, #volumeDisplay {
            color: #ffffff;
            font-size: 16px;
            padding: 6px 12px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 5px;
        }
        .spacer {
            min-width: 10px;
        }
        #overlayDisplay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.5);
            color: #ffffff;
            padding: 20px;
            border-radius: 10px;
            display: none;
            z-index: 1000;
            transition: opacity 0.3s ease;
            opacity: 0;
            pointer-events: none;
            text-align: center;
            white-space: normal;
            word-wrap: break-word;
            max-width: 80vw;
        }
        #overlayDisplay.active {
            opacity: 1;
        }
        .app-name-and-copyright {
            margin-left: auto;
            color: #ffffff;
            font-size: 12px;
            padding: 6px 12px;
            border-radius: 5px;
        }
        [data-tooltip] {
            position: relative;
        }
        .tooltip {
            position: absolute;
            background: rgba(0, 0, 0, 0.8);
            color: #ffffff;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 14px;
            white-space: nowrap;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.2s ease;
            pointer-events: none;
        }
        .tooltip.visible {
            opacity: 1;
        }
        button:hover .tooltip,
        input[type="range"]:hover .tooltip,
        input#urlInput:hover .tooltip,
        select:hover .tooltip {
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
        }
        button#modeChangeBtn.convert-active {
            background-color: #9c0000;
        }
        button#modeChangeBtn.convert-active:hover {
            background-color: #630000;
        }
        button#urlInputBtn.embed-active {
            background-color: #9c8c00;
        }
        button#urlInputBtn.embed-active:hover {
            background-color: #635400;
        }
        .url-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            display: none;
        }
        .icon-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100vw;
            height: 100vw;
            background-image: url('xPlayer-slide.gif');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            z-index: 1;
            display: none;
            opacity: 1;
            pointer-events: none;
        }
        .icon-overlay.active {
            display: block;
        }

        /* ãƒ˜ãƒ«ãƒ—ç”¨è¨­å®š */
        .help-container {
            width: 100%;
            height: 100%;
            box-sizing: border-box;
            font-size: calc(0.8vw + 0.8vh + 0.2vmin);
            padding: 1em;
            display: none;
            flex-direction: column;
        }
        .header-row {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 0.5em;
        }
        h1 {
            font-size: 2.2em;
            color: #aaccff;
            text-shadow: 0 0 0.8em rgba(0, 212, 255, 0.5);
            margin: 0;
            text-align: center;
            position: relative;
            z-index: 1;
        }
        #helpCloseBtn {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #555;
            border-radius: 50%;
            width: 2.2em;
            height: 2.2em;
            font-size: 1.3em;
            color: #ff6b6b;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 0 0.6em rgba(0, 0, 0, 0.5);
            transition: all 0.2s ease;
            z-index: 1000;
        }
        #helpCloseBtn:hover {
            background: rgba(255, 107, 107, 0.3);
            transform: translateY(-50%) scale(1.1);
            box-shadow: 0 0 1em rgba(255, 107, 107, 0.6);
        }
        #helpCloseBtn:active {
            transform: translateY(-50%) scale(0.95);
        }
        .table-container {
            width: 100%;
            height: calc(100vh - 6em);
            margin: 0 auto;
            border: 1px solid #333;
            border-radius: 1.2em;
            overflow: hidden;
            box-shadow: 0 0.6em 2em rgba(0, 0, 0, 0.6);
            background-color: #1a1a1a;
            font-size: 1.0em;
            font-weight: 400;
            display: flex;
            flex-direction: column;
            flex: 1;
            max-width: none;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
        }
        .colgroup col:nth-child(1) { width: 24%; }
        .colgroup col:nth-child(2) { width: 9%; }
        .colgroup col:nth-child(3) { width: 9%; }
        .colgroup col:nth-child(4) { width: 18%; }
        .colgroup col:nth-child(5) { width: auto; }
        .header-table {
            width: 100%;
            border-collapse: collapse;
        }
        .body-table {
            flex: 1;
            overflow-y: auto;
            display: block;
        }        
        .body-table tr:hover {
            background-color: #404040;
            transition: background-color 0.3s ease;
        }
        .header-table th {
            background-color: #0066cc;
            color: #ffffff;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            padding: 0.5em 0.5em;
            text-align: center;
            border-bottom: 1px solid #333;
            white-space: normal;
            word-wrap: break-word;
            font-size: 0.9em;
            line-height: 1.2;
        }
        .body-table td {
            padding: 0.5em 0.8em;
            text-align: center;
            border-bottom: 1px solid #333;
            white-space: normal;
            word-wrap: break-word;
            font-size: 0.9em;
            line-height: 1.0;
        }
        .body-table td:nth-child(1) {
            text-align: left;
            font-weight: 600;
        }
        .body-table td:nth-child(2) {
            font-size: 1.1em;
        }
        .body-table td:nth-child(5) {
            text-align: left;
            font-size: 0.7em;
        }
        .no-data { 
            color: #666;
        }
        caption {
            caption-side: top;
            font-size: 1.05em;
            color: #aaa;
            font-weight: 100;
            text-align: center;
            padding: 0.6em;
            background-color: #1a1a1a;
            line-height: 1.3;
        }
        .icon { font-size: 1.2em; }
    </style>
</head>
<body>
    <div class="main-container">
        <div class="video-container">
            <video id="videoPlayer" src=""></video>
            <video id="videoPreview" src="" muted></video>
            <div id="darkOverlay"></div>
            <div class="filename">
                <div class="filename-controls">
                    <button id="modeChangeBtn" data-tooltip="è¦–è´ãƒ¢ãƒ¼ãƒ‰ï¼ˆCtrl+vï¼‰">ğŸ¬</button>
                    <select id="filenameDisplay" data-tooltip="å†ç”Ÿå‹•ç”»ãƒªã‚¹ãƒˆ">
                        <option value=""></option>
                    </select>
                    <div class="filename-menus">
                        <button id="upMovePlaylistBtn" data-tooltip="ä¸Šã¸">ğŸ”¼</button>
                        <button id="downMovePlaylistBtn" data-tooltip="ä¸‹ã¸">ğŸ”½</button>
                        <button id="addPlaylistBtn" data-tooltip="è¿½åŠ ">â•</button>
                        <button id="removePlaylistBtn" data-tooltip="å‰Šé™¤">â–</button>
                        <button id="clearPlaylistBtn" data-tooltip="ã‚¯ãƒªã‚¢">ğŸ†‘</button>
                        <button id="savePlaylistBtn" data-tooltip="ä¿å­˜">ğŸ’¾</button>
                        <span class="spacer"></span>
                    </div>
                    <button id="filenameMenu" data-tooltip="ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›†">ğŸš¥</button>
                </div>
                <div class="url-controls">
                    <input id="urlInput" type="text" placeholder="å‹•ç”»ã®URLã‚’å…¥åŠ›" data-tooltip="å‹•ç”»ã®URLã‚’å…¥åŠ›">
                    <button id="urlConfirmBtn" data-tooltip="URLå†ç”Ÿï¼ˆEnterï¼‰">âœ…</button>
                    <button id="urlCancelBtn" data-tooltip="ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆEscapeï¼‰">âŒ</button>
                </div>
            </div>
            <div id="overlayDisplay"></div>
            <div id="iconOverlay" class="icon-overlay"></div>
            <div class="controls">
                <div class="control-row">
                    <div class="left-controls">
                        <button id="urlInputBtn" data-tooltip="ãƒãƒƒãƒˆå‹•ç”»é¸æŠï¼ˆCtrl+nï¼‰">ğŸŒ</button>
                        <button id="folderInput" data-tooltip="ãƒ•ã‚©ãƒ«ãƒ€é¸æŠï¼ˆCtrl+dï¼‰">ğŸ“</button>
                        <button id="videoInput" data-tooltip="ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠï¼ˆCtrl+fï¼‰">ğŸ—’ï¸</button>
                        <span class="spacer"></span>
                        <button id="prevVideoBtn" data-tooltip="å‰ã®å‹•ç”»ã¸ï¼ˆPgUpï¼‰">â®ï¸</button>
                        <button id="rewindBtn" data-tooltip="30ç§’æˆ»ã‚‹ï¼ˆCtrl+â†ï¼‰">âª</button>
                        <button id="playStopBtn" data-tooltip="åœæ­¢ï¼ˆCtrl+Spaceï¼Ctrl+Right Clickï¼‰">â¹ï¸</button>
                        <button id="playPauseBtn" data-tooltip="å†ç”Ÿï¼ˆSpaceï¼Right Clickï¼‰">â–¶ï¸</button>
                        <button id="fastForwardBtn" data-tooltip="30ç§’é€²ã‚€ï¼ˆCtrl+â†’ï¼‰">â©</button>
                        <button id="nextVideoBtn" data-tooltip="æ¬¡ã®å‹•ç”»ã¸ï¼ˆPgDwï¼‰">â­ï¸</button>
                        <span class="spacer"></span>
                        <button id="fitModeBtn" data-tooltip="æ¨ªã«åˆã‚ã›ã‚‹ï¼ˆCtrl+xï¼‰">â†”ï¸</button>
                        <select id="sizeSelect" data-tooltip="ã‚µã‚¤ã‚ºå¤‰æ›´ï¼ˆCtrl+sï¼‰">
                            <option value="10">10%</option>
                            <option value="25">25%</option>
                            <option value="50" selected>50%</option>
                            <option value="75">75%</option>
                            <option value="100">100%</option>
                        </select>
                        <button id="fullscreenBtn" data-tooltip="ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºï¼ˆCtrl+zï¼Double Clickï¼‰">ğŸ–¥ï¸</button>
                        <button id="helpOpenBtn" data-tooltip="ãƒ˜ãƒ«ãƒ—é–‹ãï¼ˆCtrl+hï¼‰">â”</button>
                    </div>
                    <label class="app-name-and-copyright" id="appNameAndCopyright"></label>
                </div>
                <div class="control-row">
                    <button id="volumeMuteBtn" data-tooltip="ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰">ğŸ”Š</button>
                    <span id="volumeDisplay" data-tooltip="éŸ³é‡ï¼ˆâ†‘â†“ï¼Swipe Up Downï¼Wheelï¼‰">20%</span>
                    <input type="range" id="volumeBar" value="0.2" min="0" max="1" step="0.01" data-tooltip="éŸ³é‡å¤‰æ›´ï¼ˆâ†‘â†“ï¼Swipe Up Downï¼‰">
                    <span id="timeDisplay" data-tooltip="å†ç”Ÿæ™‚é–“/å‹•ç”»æ™‚é–“ï¼ˆâ†â†’ï¼Swipe Left Rightï¼‰">0:00:00 / 0:00:00</span>
                    <input type="range" id="seekBar" value="0" min="0" max="100" data-tooltip="å†ç”Ÿä½ç½®å¤‰æ›´ï¼ˆâ†â†’ï¼Swipe Left Rightï¼‰">
                </div>
            </div>
        </div>
        <div class="help-container">
            <div class="header-row">
                <h1>xPlayer Ver2.38 ãƒ˜ãƒ«ãƒ—</h1>
                <button id="helpCloseBtn" data-tooltip="ãƒ˜ãƒ«ãƒ—é–‰ã˜ã‚‹ï¼ˆEscapeï¼‰">âŒ</button>
            </div>
            <div class="table-container">
                <table class="header-table">
                    <caption>æ©Ÿèƒ½åˆ¥ãƒœã‚¿ãƒ³ãƒ»ã‚­ãƒ¼æ“ä½œãƒ»ãƒã‚¦ã‚¹æ“ä½œå¯¾å¿œè¡¨</caption>
                    <colgroup class="colgroup">
                        <col><col><col><col><col>
                    </colgroup>
                    <thead>
                        <tr>
                            <th>æ©Ÿèƒ½</th>
                            <th>ãƒœã‚¿ãƒ³</th>
                            <th>ã‚­ãƒ¼æ“ä½œ</th>
                            <th>ãƒã‚¦ã‚¹æ“ä½œ</th>
                            <th>èª¬æ˜</th>
                        </tr>
                    </thead>
                </table>
                <div class="body-table">
                    <table>
                        <colgroup class="colgroup">
                            <col><col><col><col><col>
                        </colgroup>
                        <tbody>
                            <tr>
                                <td>ã€Šãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã€‹</td>
                                <td class="icon no-data"></td>
                                <td class="key no-data"></td>
                                <td class="mouse no-data"></td>
                                <td class="note no-data"></td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»å‹•ä½œãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿</td>
                                <td class="icon">ğŸ¬ï¼ğŸ”„ï¸</td>
                                <td class="key">Ctrl+v</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»xPlayerã®å‹•ä½œã‚’è¦–è´ãƒ¢ãƒ¼ãƒ‰ï¼ˆé’ï¼‰ï¼å¤‰æ›ãƒ¢ãƒ¼ãƒ‰ï¼ˆèµ¤ï¼‰ã§ãƒˆã‚°ãƒ«ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›† è¡¨ç¤ºï¼éè¡¨ç¤º</td>
                                <td class="icon">ğŸš¥</td>
                                <td class="key no-data">ãªã—</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›†ã‚’è¡¨ç¤ºï¼éè¡¨ç¤ºã§ãƒˆã‚°ãƒ«ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›† ä¸Šã¸ç§»å‹•</td>
                                <td class="icon">ğŸ”¼</td>
                                <td class="key no-data">ãªã—</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®é¸æŠã—ãŸå‹•ç”»ã‚’ä¸Šã¸ç§»å‹•ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›† ä¸‹ã¸ç§»å‹•</td>
                                <td class="icon">ğŸ”½</td>
                                <td class="key no-data">ãªã—</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®é¸æŠã—ãŸå‹•ç”»ã‚’ä¸‹ã¸ç§»å‹•ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›† å‹•ç”»è¿½åŠ </td>
                                <td class="icon">â•</td>
                                <td class="key no-data">ãªã—</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®é¸æŠä½ç½®ã«å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå†…ã®å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›† å‹•ç”»å‰Šé™¤</td>
                                <td class="icon">â–</td>
                                <td class="key no-data">ãªã—</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®é¸æŠä½ç½®ã®å‹•ç”»ã‚’å‰Šé™¤ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›† ã‚¯ãƒªã‚¢</td>
                                <td class="icon">ğŸ†‘</td>
                                <td class="key no-data">ãªã—</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å…¨å‹•ç”»ã‚’ã‚¯ãƒªã‚¢ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›† ä¿å­˜</td>
                                <td class="icon">ğŸ’¾</td>
                                <td class="key no-data">ãªã—</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’åå‰ã‚’ã¤ã‘ã¦ä¿å­˜ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€Šãƒãƒƒãƒˆå‹•ç”»ã€‹</td>
                                <td class="icon no-data"></td>
                                <td class="key no-data"></td>
                                <td class="mouse no-data"></td>
                                <td class="note no-data"></td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒãƒƒãƒˆå‹•ç”»å†ç”Ÿ URLç¢ºå®š</td>
                                <td class="icon">âœ…</td>
                                <td class="key">Enter</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒãƒƒãƒˆå‹•ç”»ã®URLã‚’ç¢ºå®šã—ãƒãƒƒãƒ—ã‚¢ã‚¦ãƒˆå†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒãƒƒãƒˆå‹•ç”»å†ç”Ÿ ã‚­ãƒ£ãƒ³ã‚»ãƒ«</td>
                                <td class="icon">âŒ</td>
                                <td class="key">Escape</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒãƒƒãƒˆå‹•ç”»ã®URLã‚’ã‚­ãƒ£ãƒ³ã‚»ãƒ«ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€Šã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«ã€‹</td>
                                <td class="icon no-data"></td>
                                <td class="key no-data"></td>
                                <td class="mouse no-data"></td>
                                <td class="note no-data"></td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒãƒƒãƒˆå‹•ç”»é¸æŠ</td>
                                <td class="icon">ğŸŒ</td>
                                <td class="key">Ctrl+n</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»YouTubeãƒ»Twichãªã©ã®å‹•ç”»ã‚’ãƒãƒƒãƒ—ã‚¢ã‚¦ãƒˆã§å†ç”Ÿã€‚ï¼ˆé’ï¼šé€šå¸¸ï¼é»„ï¼šåŸ‹ã‚è¾¼ã¿ï¼‰</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»YouTubeå‹•ç”»å†ç”Ÿã‚¢ãƒ‰ãƒ¬ã‚¹åˆ‡æ›¿</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">Ctrl+y</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»YouTubeå‹•ç”»å†ç”Ÿã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’é€šå¸¸ï¼ˆé’ï¼‰ï¼åŸ‹ã‚è¾¼ã¿ï¼ˆé»„ï¼‰ã§ãƒˆã‚°ãƒ«ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ•ã‚©ãƒ«ãƒ€é¸æŠ</td>
                                <td class="icon">ğŸ“</td>
                                <td class="key">Ctrl+d</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»é¸æŠã—ãŸãƒ•ã‚©ãƒ«ãƒ€å†…ï¼ˆéšå±¤ãƒ•ã‚©ãƒ«ãƒ€å«ã‚€ï¼‰ã®å‹•ç”»ãŠã‚ˆã³ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå†…ã®å‹•ç”»ã‚’å†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ</td>
                                <td class="icon">ğŸ—’ï¸</td>
                                <td class="key">Ctrl+f</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»é¸æŠã—ãŸå‹•ç”»ï¼ˆmp4ã€mkvã€webmï¼‰ã¾ãŸã¯ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆï¼ˆampplï¼‰å†…ã®å‹•ç”»ã‚’å†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒªã‚¹ãƒˆå…ˆé ­</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">Home</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å…ˆé ­å‹•ç”»ã‚’å†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»å‰ã®å‹•ç”»ã¸</td>
                                <td class="icon">â®ï¸</td>
                                <td class="key">PgUp</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å†ç”Ÿä¸­å‹•ç”»ã®å‰å‹•ç”»ã‚’å†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»30ç§’æˆ»ã‚‹</td>
                                <td class="icon">âª</td>
                                <td class="key">Ctrl+â†</td>
                                <td class="mouse">Ctrl+Swipe Left</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®ã¾ãŸã¯ä¸€æ™‚åœæ­¢ä¸­å‹•ç”»ã‚’30ç§’å‰ã«æˆ»ã™ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»5ç§’æˆ»ã‚‹</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">â†</td>
                                <td class="mouse">Swipe Left</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®ã¾ãŸã¯ä¸€æ™‚åœæ­¢ä¸­å‹•ç”»ã‚’5ç§’å‰ã«æˆ»ã™ã€‚ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œå¯èƒ½ï¼‰</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»åœæ­¢</td>
                                <td class="icon">â¹ï¸</td>
                                <td class="key">Ctrl+Space</td>
                                <td class="mouse">Ctrl+Right Click</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®å‹•ç”»ã‚’åœæ­¢ã€‚å†é–‹æ™‚ã¯å…ˆé ­ã‹ã‚‰å†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»å†ç”Ÿï¼ä¸€æ™‚åœæ­¢</td>
                                <td class="icon">â–¶ï¸ï¼â¸ï¸</td>
                                <td class="key">Space</td>
                                <td class="mouse">Right Click</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã§é¸æŠä¸­ã®å‹•ç”»ã‚’å†ç”Ÿï¼ˆå†é–‹ï¼‰ã¾ãŸã¯å†ç”Ÿä¸­ã®å‹•ç”»ã‚’ä¸€æ™‚åœæ­¢ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»5ç§’é€²ã‚€</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">â†’</td>
                                <td class="mouse">Swipe Right</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®ã¾ãŸã¯ä¸€æ™‚åœæ­¢ä¸­å‹•ç”»ã‚’5ç§’å…ˆã«é€²ã‚ã‚‹ã€‚ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œå¯èƒ½ï¼‰</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»30ç§’é€²ã‚€</td>
                                <td class="icon">â©</td>
                                <td class="key">Ctrl+â†’</td>
                                <td class="mouse">Ctrl+Swipe Right</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®ã¾ãŸã¯ä¸€æ™‚åœæ­¢ä¸­å‹•ç”»ã‚’30ç§’å…ˆã«é€²ã‚ã‚‹ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»æ¬¡ã®å‹•ç”»ã¸</td>
                                <td class="icon">â­ï¸</td>
                                <td class="key">PgDw</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å†ç”Ÿä¸­å‹•ç”»ã®æ¬¡å‹•ç”»ã‚’å†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒªã‚¹ãƒˆæœ€çµ‚</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">End</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®æœ€çµ‚å‹•ç”»ã‚’å†ç”Ÿã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»æ¨ªã«åˆã‚ã›ã‚‹ï¼ç¸¦ã«åˆã‚ã›ã‚‹</td>
                                <td class="icon">â†”ï¸ï¼â†•ï¸</td>
                                <td class="key">Ctrl+x</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»å†ç”Ÿå‹•ç”»ã‚’ç”»é¢ã®æ¨ªå¹…ã¾ãŸã¯ç¸¦å¹…ã«åˆã‚ã›ã¦æ‹¡å¤§ãƒ»ç¸®å°ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ã‚µã‚¤ã‚ºå¤‰æ›´</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">Ctrl+s</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œãƒœã‚¿ãƒ³ãªã©ã®ã‚µã‚¤ã‚ºã‚’å¤‰æ›´ã€‚ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œå¯èƒ½ï¼‰</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºï¼è§£é™¤</td>
                                <td class="icon">ğŸ–¥ï¸ï¼âŒ</td>
                                <td class="key">Ctrl+z</td>
                                <td class="mouse">Double Click</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºã¾ãŸã¯ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦è¡¨ç¤ºã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒ˜ãƒ«ãƒ—é–‹ã</td>
                                <td class="icon">â”</td>
                                <td class="key">Ctrl+h</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æ“ä½œèª¬æ˜ï¼ˆå½“ç”»é¢ï¼‰ã‚’é–‹ãã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ãƒŸãƒ¥ãƒ¼ãƒˆè¨­å®šï¼è§£é™¤</td>
                                <td class="icon">ğŸ”‡ï¼ğŸ”Š</td>
                                <td class="key">Ctrl+m</td>
                                <td class="mouse no-data">ãªã—</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®å‹•ç”»ã®éŸ³å£°ã‚’ãƒŸãƒ¥ãƒ¼ãƒˆã¾ãŸã¯ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»éŸ³é‡ï¼</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">â†‘</td>
                                <td class="mouse">Swipe Upï¼Wheel Up</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®å‹•ç”»ã®éŸ³é‡ã‚’ä¸‹ã’ã‚‹ã€‚ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œå¯èƒ½ï¼‰</td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»éŸ³é‡ï¼‹</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">â†“</td>
                                <td class="mouse">Swipe Downï¼Wheel Down</td>
                                <td class="note">ãƒ»å†ç”Ÿä¸­ã®å‹•ç”»ã®éŸ³é‡ã‚’ä¸Šã’ã‚‹ã€‚ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œå¯èƒ½ï¼‰</td>
                            </tr>
                            <tr>
                                <td>ã€Šãã®ä»–ã€‹</td>
                                <td class="icon no-data"></td>
                                <td class="key no-data"></td>
                                <td class="mouse no-data"></td>
                                <td class="note no-data"></td>
                            </tr>
                            <tr>
                                <td>ã€€ã€€ãƒ»ï¾Œï¾Ÿï¾šï½²ï¾˜ï½½ï¾„ãƒ»ï½ºï¾ï¾„ï¾›ï½°ï¾™è¡¨ç¤ºï¼éè¡¨ç¤º</td>
                                <td class="icon no-data">ãªã—</td>
                                <td class="key">Ctrl+c</td>
                                <td class="mouse">Click</td>
                                <td class="note">ãƒ»å·¦ã‚¯ãƒªãƒƒã‚¯ã§ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«è¡¨ç¤ºï¼éè¡¨ç¤ºã‚’ãƒˆã‚°ãƒ«ã€‚ï¼ˆ3ç§’ã§è‡ªå‹•éè¡¨ç¤ºï¼‰</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ---------------------------------------------------------------------
        const copyright = 'Copyright Â© 2025 @x-builder, Japan';
        const email = 'x-builder@gmail.com';
        const appName = 'xPlayer -å‹•ç”»ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼- Ver2.39';
        // ---------------------------------------------------------------------
        // [å¤‰æ›´å±¥æ­´]
        // 2025-10-24 Ver2.00 ï¼ˆWindowsç‰ˆï¼‰ã®é–‹ç™º
        //    ãƒ»folderInputã€videoInputã®Windows APIãƒ€ã‚¤ã‚¢ãƒ­ã‚°å¯¾å¿œï¼ˆnode.jsä½¿ç”¨ï¼‰
        //    ãƒ»folderInputã‚¯ãƒªãƒƒã‚¯æ™‚ã®éšå±¤ãƒ•ã‚©ãƒ«ãƒ€èª­è¾¼å¯¾å¿œï¼ˆnode.jsä½¿ç”¨ï¼‰
        //    ãƒ»folderInputã€videoInputã‚¯ãƒªãƒƒã‚¯æ™‚ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ.ampplï¼‰ã®èª­è¾¼å¯¾å¿œï¼ˆnode.jsä½¿ç”¨ï¼‰
        //    ãƒ»filenameDisplayã«å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ•ãƒ«ãƒ‘ã‚¹ã‚’è¡¨ç¤º
        // 2025-10-24 Ver2.01 èµ·å‹•ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰æ™‚ã€å‰å›ã®å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ã€æ™‚é–“ã§å†é–‹ã•ã‚Œãªã„ã€‚
        // 2025-10-24 Ver2.02 å†é–‹å¯¾è±¡ãƒœã‚¿ãƒ³ã®åˆ¤å®šæ–¹æ³•ã®å¤‰æ›´
        //    ãƒ»å¤‰æ›´å‰ï¼šãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå†…ã®ä»¶æ•°ãŒ1ä»¶ã®å ´åˆvideoInputã€2ä»¶ä»¥ä¸Šã®å ´åˆfolderInput
        //    ãƒ»å¤‰æ›´å¾Œï¼šé¸æŠãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯æ™‚ã«localStorageã«é¸æŠãƒœã‚¿ãƒ³ï¼ˆvideoInputã€folderInputï¼‰ã‚’ä¿å­˜ã€åˆ¤å®šæ™‚ã«localStorageã‹ã‚‰é¸æŠãƒœã‚¿ãƒ³ã‚’å–å¾—
        // 2025-10-24 Ver2.03 ãƒãƒƒãƒˆå‹•ç”»å†ç”Ÿæ™‚ã€volumeBarã€volumeMuteBtnã®çŠ¶æ…‹ã‚’åæ˜ ã€‚
        // 2025-10-24 Ver2.04 ãƒãƒƒãƒˆå‹•ç”»å†ç”Ÿä¸­ã€overlayDisplayã‚’éè¡¨ç¤ºã€‚
        // 2025-10-24 Ver2.05 YouTubeå‹•ç”»å†ç”Ÿæ™‚ã«ç™ºç”Ÿã™ã‚‹1ã‚¨ãƒ©ãƒ¼ã«å¯¾å¿œã€‚
        // 2025-10-25 Ver2.06 ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚µã‚¤ã‚ºå¤‰æ›´æ™‚ã®overlayDisplayè¡¨ç¤ºã‚’å‰Šé™¤ã€‚
        // 2025-10-25 Ver2.07 YouTubeå‹•ç”»ã®å†ç”Ÿæ–¹æ³•ã‚’å¤–éƒ¨ï¼ˆChromeï¼‰èµ·å‹•ã«å¤‰æ›´ã€‚ğŸŒã‚¯ãƒªãƒƒã‚¯æ™‚ã®URLè‡ªå‹•è²¼ã‚Šä»˜ã‘æ©Ÿèƒ½è¿½åŠ ã€‚
        // 2025-10-25 Ver2.08 Twitchã€YouTubeã‚·ãƒ§ãƒ¼ãƒˆã®å‹•ç”»å†ç”Ÿæ©Ÿèƒ½è¿½åŠ ã€‚ï¼ˆä¸è¦ãªèµ·å‹•æ™‚ãƒªã‚¹ãƒŠãƒ¼å‰Šé™¤ï¼‰
        // 2025-10-25 Ver2.09 å†ç”Ÿåœæ­¢ãƒœã‚¿ãƒ³ï¼ˆâ¹ï¸ï¼‰ã®è¿½åŠ ã€‚
        // 2025-10-26 Ver2.10 å†ç”Ÿé€”ä¸­ã®å‹•ç”»ã®å†ç”Ÿã‚¿ã‚¤ãƒŸãƒ³ã‚°ã«èµ·å‹•ç›´å¾Œã«ä¸€æ™‚åœæ­¢ã‚’è¿½åŠ 
        //    ãƒ»èµ·å‹•ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰æ™‚ã«localStorageã«ä¿å­˜ã•ã‚Œã¦ã„ã‚‹æƒ…å ±ã‚’å–å¾—
        //    ãƒ»ãƒœãƒªãƒ¥ãƒ¼ãƒ é‡ã€ãƒŸãƒ¥ãƒ¼ãƒˆçŠ¶æ…‹ã€æç”»ãƒ¢ãƒ¼ãƒ‰ã‚’è¨­å®š
        //    ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚’å‰å›ã®çŠ¶æ…‹ã«å¾©å…ƒ
        //    ãƒ»å†ç”Ÿå‹•ç”»ã®ãƒãƒ¼ã‚¯ï¼ˆâ–¶ï¸ï¼‰ã‚’è¨­å®š
        //    ãƒ»å†ç”Ÿé€”ä¸­ã®æ™‚é–“ã§å†ç”Ÿ
        //    ãƒ»å†ç”Ÿç›´å¾Œã«ä¸€æ™‚åœæ­¢
        // 2025-10-26 Ver2.11 ãƒ•ã‚©ãƒ«ãƒ€é¸æŠã€ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã®æ©Ÿèƒ½è¦‹ç›´ã—ã€‚
        //    ãƒ»èµ·å‹•ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰å¾Œã®ãƒ•ã‚©ãƒ«ãƒ€é¸æŠã€ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã®å†ç”Ÿå†é–‹æ©Ÿèƒ½ã®å‰Šé™¤ã€‚
        //    ãƒ»èµ·å‹•ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰å¾Œã®ãƒ•ã‚©ãƒ«ãƒ€é¸æŠã€ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã®èµ¤è‰²ã®å‰Šé™¤ã€‚
        //    ãƒ»èµ·å‹•ï¼ˆãƒªãƒ­ãƒ¼ãƒ‰ï¼‰å¾Œã®ãƒ•ã‚©ãƒ«ãƒ€é¸æŠã€ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã®ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼æ™‚ã®å†é–‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®å‰Šé™¤ã€‚
        // 2025-10-26 Ver2.12 YouTubeAPIä½¿ç”¨ã®å»ƒæ­¢ã«ä¼´ã†è¦‹ç›´ã—ã€‚
        // 2025-10-26 Ver2.13 Twitchãƒ©ã‚¤ãƒ–ã®å‹•ç”»å†ç”Ÿæ©Ÿèƒ½è¿½åŠ ã€‚
        // 2025-10-26 Ver2.14 å†ç”Ÿåœæ­¢ä¸­ã€ç”»é¢ä¸­å¤®ã«ã‚¢ã‚¤ã‚³ãƒ³ï¼ˆç‰¹å¤§ï¼‰ã‚’è¡¨ç¤ºã€‚å‹•ç”»å†ç”Ÿä¸­ã€ä¸€æ™‚åœæ­¢ä¸­ã¯éè¡¨ç¤ºã€‚
        // 2025-10-26 Ver2.15 èµ·å‹•æ™‚ã€å†ç”Ÿçµ‚äº†æ™‚ã«iconOverlayã‚’è¡¨ç¤ºã€‚
        //ã€€ã€€ãƒ»èµ·å‹•æ™‚ã«å¾©å…ƒã™ã‚‹ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆï¼ˆå‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰å­˜åœ¨ã—ãªã„å ´åˆã€iconOverlayã‚’è¡¨ç¤ºã€‚
        //ã€€ã€€ãƒ»ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å‹•ç”»ã‚’å…¨ã¦å†ç”Ÿã—ãŸå ´åˆã€iconOverlayã‚’è¡¨ç¤ºã€‚
        // 2025-10-27 Ver2.16 ãƒãƒƒãƒˆå‹•ç”»URLå…¥åŠ›æ™‚ã€ENTERã§URKå†ç”Ÿï¼ˆâœ…ï¼‰ã€CANCELã§ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆâŒï¼‰ã‚’å®Ÿè¡Œã€‚
        // 2025-10-27 Ver2.17 å³ã‚¯ãƒªãƒƒã‚¯ã®å†ç”Ÿï¼ä¸€æ™‚åœæ­¢æ©Ÿèƒ½ã‚’å·¦ã‚¯ãƒªãƒƒã‚¯ã«å¤‰æ›´ã€‚ãƒãƒƒãƒˆå‹•ç”»ã®è‡ªå‹•å†ç”Ÿæ©Ÿèƒ½è¿½åŠ ã€‚
        // 2025-10-27 Ver2.18 ã‚¢ã‚¤ã‚³ãƒ³æ“ä½œã¨ã‚­ãƒ¼æ“ä½œã®å‡¦ç†å…±é€šåŒ–ã€ã‚­ãƒ¼å‰²å½“ã€ãƒã‚¦ã‚¹æ“ä½œå‰²å½“ã®è¦‹ç›´ã—ã€‚
        // 2025-10-28 Ver2.19 ãƒ›ã‚¤ãƒ¼ãƒ«ã®å¢—æ¸›é‡ã®è¦‹ç›´ã—ã€ãƒã‚¦ã‚¹ç§»å‹•æ™‚ã®filenameã€controlsã®è¡¨ç¤ºã‚’è¦‹ç›´ã—ã€‚
        // 2025-10-28 Ver2.20 ãƒã‚¦ã‚¹ã®å·¦ã‚¯ãƒªãƒƒã‚¯ã§filenameã€overlayDisplayã€controlsã®è¡¨ç¤ºï¼éè¡¨ç¤ºã‚’ãƒˆã‚°ãƒ«ã€‚
        // 2025-10-28 Ver2.21 å†ç”Ÿåœæ­¢ä¸­ã®ãƒ­ã‚´ã‚’GIFã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã«å¤‰æ›´
        // 2025-10-29 Ver2.22 ãƒ˜ãƒ«ãƒ—è¡¨ç¤ºæ©Ÿèƒ½ã®è¿½åŠ 
        // 2025-10-30 Ver2.23 ã‚·ãƒ¼ã‚¯ãƒãƒ¼ã®ãƒ‰ãƒ©ãƒƒã‚¯ä¸­ã«ã‚·ãƒ¼ã‚¯ãƒãƒ¼ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒ¯ã‚¤ãƒ—è¡¨ç¤ºï¼‰æ©Ÿèƒ½è¿½åŠ ã€‚
        // 2025-10-30 Ver2.24 filenameã€controlsã®è¡¨ç¤ºï¼éè¡¨ç¤ºã‚¿ã‚¤ãƒŸãƒ³ã‚°è¦‹ç›´ã—
        // 2025-10-31 Ver2.25 YouTubeå‹•ç”»å†ç”Ÿã‚¢ãƒ‰ãƒ¬ã‚¹åˆ‡æ›¿æ©Ÿèƒ½è¿½åŠ ã€‚
        // 2025-11-01 Ver2.26 ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒ¯ã‚¤ãƒ—ï¼‰æ©Ÿèƒ½å®Œå…¨å‰Šé™¤
        // 2025-11-01 Ver2.27 seekBarãƒ›ãƒãƒ¼æ™‚ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆãƒ¯ã‚¤ãƒ—ï¼‰è¡¨ç¤ºã®å®Ÿè£…è¦‹ç›´ã—ã€‚
        // 2025-11-01 Ver2.29 ControlSizeè¨ˆç®—ã®é–¾å€¤ã®è¦‹ç›´ã—ã€‚
        // 2025-11-01 Ver2.30 åˆæœŸå‡¦ç†ã€é–¢æ•°ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ™ãƒ³ãƒˆã€ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®æ•´ç†ã€‚
        // 2025-11-02 Ver2.31 ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³å¼•æ•°å†ç”Ÿæ©Ÿèƒ½è¿½åŠ ã€‚
        // 2025-11-03 Ver2.32 ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ã‚µã‚¤ã‚ºãƒ»ä½ç½®èª¿æ•´ã€‚
        // 2025-11-03 Ver2.33 éè¡¨ç¤ºä¸­ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«å†…ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå®Œå…¨ç„¡åŠ¹åŒ–ã€‚
        // 2025-11-04 Ver2.34 å¤–éƒ¨ã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ï¼ˆFFmpegï¼‰ã§HTML5éå¯¾å¿œã‚³ãƒ¼ãƒ‡ãƒƒã‚¯ã®å‹•ç”»å†ç”Ÿ
        // 2025-11-07 Ver2.35 ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›†ãƒ»ä¿å­˜æ©Ÿèƒ½è¿½åŠ 
        // 2025-11-08 Ver2.36 å®Ÿè¡Œç’°å¢ƒãŒç„¡ã„ãŸã‚ã‚¿ãƒƒãƒæ©Ÿèƒ½å‰Šé™¤ã€ãã®ä»–ä¸è¦å¤‰æ•°ãƒ»å‡¦ç†ã‚’å‰Šé™¤ã€‚
        // 2025-11-08 Ver2.37 FFmpegå¤‰æ›ã§ä½œæˆã•ã‚ŒãŸä¸€æ™‚mp4ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ï¼éå‰Šé™¤ï¼å…¥æ›¿ã‚’åˆ¶å¾¡ã€‚å¤‰æ›ä¸­ã®ä¸­æ–­æ©Ÿèƒ½è¿½åŠ ã€‚
        // 2025-11-09 Ver2.38 å‹•ä½œãƒ¢ãƒ¼ãƒ‰ã‚’è¦–è´ï¼ˆğŸ¬ï¼‰ï¼å¤‰æ›ï¼ˆğŸ”„ï¸ï¼‰ã§åˆ‡ã‚Šæ›¿ãˆã‚‹ã€‚ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤åˆ¶å¾¡ã‚’ç„¡åŠ¹åŒ–ã€‚
        // 2025-11-09 Ver2.39 FFmpegå¤‰æ›ã§æ—¥æœ¬èªã®éŸ³å£°ã€å­—å¹•ã§ã‚³ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹æ©Ÿèƒ½è¿½åŠ ã€‚
        // ---------------------------------------------------------------------

        // ğŸ”²åˆæœŸå‡¦ç†ğŸ”²
        // Electronãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¤ãƒ³ãƒãƒ¼ãƒˆ
        const { ipcRenderer } = require('electron');
        const { exec } = require('child_process');

        // è¡¨ç¤ºè¨­å®š
        const overlayTimeout = 3000;
        const seekSensitivity = 0.3;
        const volumeStep = 0.005;
        const appNameAndCopyrightValue = `${appName}ã€€${copyright}`;
        const localAppData = process.env.LOCALAPPDATA;
        const application = `${localAppData}\\Google\\Chrome\\Application\\chrome.exe`;
        const fs = require('fs');
        const path = require('path');
        const HTML5_SUPPORTED = ['.mp4', '.webm', '.ogg', '.mov', '.m4v', '.mkv'];  // HTML5ãƒã‚¤ãƒ†ã‚£ãƒ–å¯¾å¿œæ‹¡å¼µå­ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãŒç›´æ¥å†ç”Ÿå¯èƒ½ï¼‰
        const HTML5_SUPPORTED_CONVERT = ['.mp4'];  // HTML5ãƒã‚¤ãƒ†ã‚£ãƒ–å¯¾å¿œæ‹¡å¼µå­ï¼ˆãƒ–ãƒ©ã‚¦ã‚¶ãŒç›´æ¥å†ç”Ÿå¯èƒ½ï¼‰

        // DOMè¦ç´ å–å¾—
        const videoPlayer = document.getElementById('videoPlayer');
        const videoPreview = document.getElementById('videoPreview');
        const mainContainer = document.querySelector('.main-container');
        const videoContainer = document.querySelector('.video-container');
        const controls = document.querySelector('.controls');
        const folderInput = document.getElementById('folderInput');
        const videoInput = document.getElementById('videoInput');
        const urlInputBtn = document.getElementById('urlInputBtn');
        const urlInput = document.getElementById('urlInput');
        const urlConfirmBtn = document.getElementById('urlConfirmBtn');
        const urlCancelBtn = document.getElementById('urlCancelBtn');
        const urlControls = document.querySelector('.url-controls');
        const prevVideoBtn = document.getElementById('prevVideoBtn');
        const rewindBtn = document.getElementById('rewindBtn');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playStopBtn = document.getElementById('playStopBtn');
        const fastForwardBtn = document.getElementById('fastForwardBtn');
        const nextVideoBtn = document.getElementById('nextVideoBtn');
        const seekBar = document.getElementById('seekBar');
        const volumeMuteBtn = document.getElementById('volumeMuteBtn');
        const volumeBar = document.getElementById('volumeBar');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const sizeSelect = document.getElementById('sizeSelect');
        const fitModeBtn = document.getElementById('fitModeBtn');
        const filename = document.querySelector('.filename');
        const filenameControls = document.querySelector('.filename-controls');
        const filenameDisplay = document.getElementById('filenameDisplay');
        const timeDisplay = document.getElementById('timeDisplay');
        const volumeDisplay = document.getElementById('volumeDisplay');
        const overlayDisplay = document.getElementById('overlayDisplay');
        const iconOverlay = document.getElementById('iconOverlay');
        const appNameAndCopyright = document.getElementById('appNameAndCopyright');
        const helpOpenBtn = document.getElementById('helpOpenBtn');
        const helpCloseBtn = document.getElementById('helpCloseBtn');
        const helpContainer = document.querySelector('.help-container');
        const helpTitle = helpContainer.querySelector('h1');
        const tooltipElements = document.querySelectorAll('[data-tooltip]');
        const filenameMenus = document.querySelector('.filename-menus');
        const filenameMenu = document.getElementById('filenameMenu');
        const upMovePlaylistBtn = document.getElementById('upMovePlaylistBtn');
        const downMovePlaylistBtn = document.getElementById('downMovePlaylistBtn');
        const addPlaylistBtn = document.getElementById('addPlaylistBtn');
        const removePlaylistBtn = document.getElementById('removePlaylistBtn');
        const clearPlaylistBtn = document.getElementById('clearPlaylistBtn');
        const savePlaylistBtn = document.getElementById('savePlaylistBtn');
        const modeChangeBtn = document.getElementById('modeChangeBtn');

        // localStorage ã‹ã‚‰å¾©å…ƒ
        const savedControlSize = localStorage.getItem('controlSize');
        const savedVolume = localStorage.getItem('volume');
        const savedPlaylist = localStorage.getItem('playlist');
        const savedCurrentVideoIndex = localStorage.getItem('currentVideoIndex');
        const savedCurrentTime = localStorage.getItem('currentTime');
        const savedFitMode = localStorage.getItem('fitMode');
        const savedYoutubeAdd = localStorage.getItem('youtubeAdd');

        // çŠ¶æ…‹å¤‰æ•°åˆæœŸåŒ–
        let playlist = [];
        let currentVideoIndex = 0;
        let timeout;
        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        let isVolumeDragging = false;
        let lastVolume = 0.2;
        let wasPlaying = false;
        let isMouseOverControls = false;
        let isInitialLoad = true;
        let saveInterval = null;
        let fitMode = 'contain';
        let controlTimeout;
        let isHelpOpen = false;
        let isSeekDragging = false;
        let isMouseOverSeekBar = false;
        let seekUpdateInterval = null;
        let youtubeAdd = savedYoutubeAdd;
        let isConverting = false;   // å¤‰æ›ä¸­ãƒ•ãƒ©ã‚°
        let currentConvertPromise = null;  // Promiseä¿æŒ
        let videoPlayerActive = false;
        let modeChange = 'video';

        // åˆæœŸçŠ¶æ…‹è¨­å®š
        videoPlayer.src = '';
        videoPreview.src = videoPlayer.src;
        appNameAndCopyright.textContent = appNameAndCopyrightValue;
        filenameMenus.style.display = 'none';

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚µã‚¤ã‚ºé©ç”¨
        let initialControlSize = savedControlSize && ['10', '25', '50', '75', '100'].includes(savedControlSize)
            ? parseInt(savedControlSize) : calculateControlSize();
        sizeSelect.value = initialControlSize;
        updateControlSize(initialControlSize, true);

        // ãƒãƒƒãƒˆå‹•ç”»é¸æŠè‰²å¤‰æ›´
        if (youtubeAdd === 'embed') {
            urlInputBtn.classList.add('embed-active');
        } else {
            urlInputBtn.classList.remove('embed-active');
            youtubeAdd = 'normal';
        }
        localStorage.setItem('youtubeAdd', youtubeAdd);

        // ãƒœãƒªãƒ¥ãƒ¼ãƒ å¾©å…ƒ
        if (savedVolume && !isNaN(savedVolume) && savedVolume >= 0 && savedVolume <= 1) {
            volumeBar.value = savedVolume;
            videoPlayer.volume = savedVolume;
            lastVolume = savedVolume;
            volumeMuteBtn.textContent = savedVolume == 0 ? 'ğŸ”‡' : 'ğŸ”Š';
            volumeMuteBtn.setAttribute('data-tooltip', savedVolume == 0 ? 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰' : 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
            updateVolumeDisplay();
        } else {
            volumeBar.value = 0.2;
            videoPlayer.volume = 0.2;
            lastVolume = 0.2;
            volumeMuteBtn.textContent = 'ğŸ”Š';
            volumeMuteBtn.setAttribute('data-tooltip', 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
            updateVolumeDisplay();
        }

        // æç”»ãƒ¢ãƒ¼ãƒ‰å¾©å…ƒ
        if (savedFitMode && ['contain', 'cover'].includes(savedFitMode)) {
            fitMode = savedFitMode;
            videoPlayer.style.objectFit = fitMode;
            fitModeBtn.textContent = fitMode === 'contain' ? 'â†”ï¸' : 'â†•ï¸';
            fitModeBtn.setAttribute('data-tooltip', fitMode === 'contain' ? 'æ¨ªã«åˆã‚ã›ã‚‹ï¼ˆCtrl+xï¼‰' : 'ç¸¦ã«åˆã‚ã›ã‚‹ï¼ˆCtrl+xï¼‰');
        } else {
            fitMode = 'contain';
            videoPlayer.style.objectFit = fitMode;
            fitModeBtn.textContent = 'â†”ï¸';
            fitModeBtn.setAttribute('data-tooltip', 'æ¨ªã«åˆã‚ã›ã‚‹ï¼ˆCtrl+xï¼‰');
        }

        // èµ·å‹•æ™‚ã®å¼•æ•°æœ‰ç„¡åˆ¤å®š
        (async () => {
            const args = await ipcRenderer.invoke('get-command-line-args');
            if (args && args.length > 0) {
                // main.js ãŒ auto-play-files ã‚’é€ä¿¡ã™ã‚‹ã®ã§ã€ã“ã“ã§ã¯ä½•ã‚‚ã—ãªã„
                return;
            }

            // å¼•æ•°ãªã— â†’ ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¨å†ç”ŸçŠ¶æ…‹å¾©å…ƒ
            if (savedPlaylist && savedCurrentVideoIndex && savedCurrentTime) {
                try {
                    const parsedPlaylist = JSON.parse(savedPlaylist);
                    const parsedCurrentVideoIndex = parseInt(savedCurrentVideoIndex);
                    if (Array.isArray(parsedPlaylist) && parsedPlaylist.length > 0 && parsedCurrentVideoIndex >= 0 && parsedCurrentVideoIndex < parsedPlaylist.length) {
                        playlist = parsedPlaylist.map(path => ({
                            file: { path },
                            name: path
                        }));
                        currentVideoIndex = parsedCurrentVideoIndex;
                        playVideo(playlist[currentVideoIndex].file);
                        videoPlayer.pause();          // å¸¸ã«ä¸€æ™‚åœæ­¢
                    } else {
                        filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                        iconOverlay.classList.add('active');
                    }
                } catch (e) {
                    console.error('ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå¾©å…ƒã‚¨ãƒ©ãƒ¼:', e);
                    filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                    iconOverlay.classList.add('active');
                }
            } else {
                filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                iconOverlay.classList.add('active');
            }
        })();

        // ğŸ”²é–¢æ•°ğŸ”²
        // æ™‚é–“ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆå¤‰æ›
        function formatTime(seconds) {
            if (isNaN(seconds)) return '0:00:00';
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = Math.floor(seconds % 60);
            return `${hours}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
        }

        // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰è²¼ã‚Šä»˜ã‘
        async function pasteFromClipboard() {
            return new Promise(async (resolve, reject) => {
                const timeout = setTimeout(() => {
                    reject(new Error('ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®èª­ã¿è¾¼ã¿ã«1000msä»¥ä¸Šã‹ã‹ã‚Šã¾ã—ãŸ'));
                }, 3000);

                try {
                    const text = await navigator.clipboard.readText();
                    const platform = isTwitchOrYouTube(text);

                    let videoId = null;
                    if (platform === 'Twitch') {
                        videoId = extractTwitchVideoId(text);
                    } else if (platform === 'YouTube') {
                        videoId = extractYouTubeVideoId(text);
                    } else if (platform === 'Other') {
                        videoId = text;
                    }
                    if (!videoId) {
                        resolve(null);
                    } else {
                        urlInput.value = text;
                        clearTimeout(timeout);
                        resolve(text);
                    }
                } catch (err) {
                    clearTimeout(timeout);
                    reject(new Error(`ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—: ${err.message}`));
                }
            });
        }
        
        // ç”»é¢å¹…ã‹ã‚‰ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚µã‚¤ã‚ºè¨ˆç®—
        function calculateControlSize() {
            const screenWidth = window.innerWidth;
            let sizePercent;
            if (screenWidth <= 680) {
                sizePercent = 10;
            } else if (screenWidth <= 1310) {
                sizePercent = 25;
            } else if (screenWidth <= 1623) {
                sizePercent = 50;
            } else if (screenWidth <= 1940) {
                sizePercent = 75;
            } else {
                sizePercent = 100;
            }
            return sizePercent;
        }

        // ãƒ•ã‚©ãƒ³ãƒˆãƒ»ãƒ‘ãƒ‡ã‚£ãƒ³ã‚°å‹•çš„æ›´æ–°
        function updateControlSize(value, isInitial = false) {
            const fontSize = 8 + (value / 100) * (24 - 8);
            const padding = 2 + (value / 100) * (10 - 2);
            const appNameAndCopyrightFontSize = 8 + (value / 100) * (17 - 8);
            const appNameAndCopyrightPadding = 2 + (value / 100) * (8 - 2);
            const sizeSelectWidth = 40 + (value / 100) * (124 - 40);
            const controls = document.querySelectorAll('button, select#filenameDisplay, select#sizeSelect, #timeDisplay, #volumeDisplay, #appNameAndCopyright, input#urlInput');
            controls.forEach(control => {
                if (control.id === 'appNameAndCopyright') {
                    control.style.fontSize = `${appNameAndCopyrightFontSize}px`;
                    control.style.padding = `${appNameAndCopyrightPadding}px ${appNameAndCopyrightPadding * 2}px`;
                } else {
                    control.style.fontSize = `${fontSize}px`;
                    control.style.padding = `${padding}px ${padding * 2}px`;
                }
                if (control.id === 'sizeSelect') {
                    control.style.width = `${sizeSelectWidth}px`;
                }
            });

            const overlayFontSize = 20 + (value / 100) * (160 - 20);
            overlayDisplay.style.fontSize = `${overlayFontSize}px`;
            isInitialLoad = false;
        }

        // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—è¡¨ç¤º
        function showTooltip(element) {
            if (element.dataset.tooltip) {
                let tooltip = element.querySelector('.tooltip');
                if (!tooltip) {
                    tooltip = document.createElement('div');
                    tooltip.className = 'tooltip';
                    tooltip.textContent = element.dataset.tooltip;
                    element.appendChild(tooltip);
                }
                tooltip.classList.add('visible');
            }
        }

        // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—éè¡¨ç¤º
        function hideTooltip(element) {
            const tooltip = element.querySelector('.tooltip');
            if (tooltip) {
                tooltip.classList.remove('visible');
            }
        }

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼‹ãƒ•ã‚¡ã‚¤ãƒ«åè¡¨ç¤ºï¼ˆã‚¿ã‚¤ãƒãƒ¼ä»˜ãï¼‰
        function showControlsAndFilename() {
            disabledControls(false);
            disabledfilename(false);
            videoContainer.style.cursor = 'auto';
            if (overlayDisplay.classList.contains('active')) {
                overlayDisplay.style.display = 'block';
                overlayDisplay.classList.add('active');
            }
            clearTimeout(timeout);
            if (!isMouseOverControls) {
                timeout = setTimeout(() => {
                    if (!isMouseOverControls) {
                        hideControlsAndFilename(); // ã“ã“ã§ç„¡åŠ¹åŒ–
                    }
                }, overlayTimeout);
            }
            updateIconOverlay();
        }

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ï¼‹ãƒ•ã‚¡ã‚¤ãƒ«åéè¡¨ç¤º
        function hideControlsAndFilename() {
            disabledControls(true);
            disabledfilename(true);
            overlayDisplay.classList.remove('active');
            videoContainer.style.cursor = 'none';
            clearTimeout(timeout);
            setTimeout(() => {
                overlayDisplay.style.display = 'none';
            }, 300);
            updateIconOverlay();
        }

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ«æœ‰åŠ¹åŒ–ï¼ç„¡åŠ¹åŒ–
        function disabledControls(disable) {
            if (disable) {
                controls.style.opacity = '0';
                controls.style.pointerEvents = 'none';
            } else {
                controls.style.opacity = '1';
                controls.style.pointerEvents = 'auto';
            }
            urlInputBtn.disable = disable;
            folderInput.disable = disable;
            videoInput.disable = disable;
            prevVideoBtn.disable = disable;
            rewindBtn.disable = disable;
            playStopBtn.disable = disable;
            playPauseBtn.disable = disable;
            fastForwardBtn.disable = disable;
            nextVideoBtn.disable = disable;
            fitModeBtn.disable = disable;
            sizeSelect.disable = disable;
            fullscreenBtn.disable = disable;
            helpOpenBtn.disable = disable;
            volumeMuteBtn.disable = disable;
            volumeBar.disable = disable;
            seekBar.disable = disable;
        }

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæœ‰åŠ¹åŒ–ï¼ç„¡åŠ¹åŒ–
        function disabledfilename(disable) {
            if (disable) {
                filename.style.opacity = '0';
                // ã€è¿½åŠ ã€‘pointer-eventsç„¡åŠ¹åŒ– â†’ å†…åŒ…ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæ“ä½œä¸å¯
                filename.style.pointerEvents = 'none';
            } else {
                filename.style.opacity = '1';
                // ã€è¿½åŠ ã€‘pointer-eventsæœ‰åŠ¹åŒ–
                filename.style.pointerEvents = 'auto';
            }
            filenameDisplay.disable = disable;
        }

        // å†ç”Ÿæ™‚é–“è¡¨ç¤ºæ›´æ–°
        function updateTimeDisplay() {
            const currentTime = formatTime(videoPlayer.currentTime);
            const duration = formatTime(videoPlayer.duration);
            timeDisplay.textContent = `${currentTime} / ${duration}`;
            updateIconOverlay();
        }

        // éŸ³é‡è¡¨ç¤ºæ›´æ–°
        function updateVolumeDisplay() {
            const volumePercent = Math.round(videoPlayer.volume * 100);
            volumeDisplay.textContent = `${volumePercent}%`;
            updateIconOverlay();
        }

        // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¡¨ç¤º
        function updateOverlayDisplay(content, isInitial = false) {
            overlayDisplay.textContent = content;
            const overlayFontSize = parseFloat(overlayDisplay.style.fontSize) || 90;
            const charCount = content.length;
            const charWidth = overlayFontSize * 0.6;
            let overlayWidth = charCount * charWidth + 40;
            overlayWidth = Math.max(200, Math.min(overlayWidth, window.innerWidth * 0.8));
            overlayDisplay.style.width = `${overlayWidth}px`;
            overlayDisplay.style.display = 'block';
            overlayDisplay.classList.add('active');
            if (!isInitial) {
                showControlsAndFilename();
            }
            updateIconOverlay();
        }

        // ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤éè¡¨ç¤º
        function hideOverlayDisplay() {
            overlayDisplay.classList.remove('active');
            setTimeout(() => {
                overlayDisplay.style.display = 'none';
            }, 300);
            updateIconOverlay();
        }

        // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ä½ç½®æ›´æ–°é–¢æ•°
        function updatePreviewPosition(e) {
            const previewWidth = 180;
            const previewHeight = 100;
            const seekRect = seekBar.getBoundingClientRect();

            // ã‚«ãƒ¼ã‚½ãƒ«ã‚’ä¸­å¿ƒã«æ¨ªä½ç½®ã‚’è¨ˆç®—
            let x = e.clientX - previewWidth / 2;

            // ç”»é¢å¤–ã«å‡ºãªã„ã‚ˆã†èª¿æ•´
            // å³å´ãŒã¯ã¿å‡ºã‚‹å ´åˆ
            if (x + previewWidth > window.innerWidth) {
                x = window.innerWidth - previewWidth - 10;
            }
            // å·¦å´ãŒã¯ã¿å‡ºã‚‹å ´åˆ
            if (x < 0) {
                x = 10;
            }
            // Yè»¸ï¼šseekBarã®ç›´ä¸Šã«å›ºå®šï¼ˆãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é«˜ã• + ä½™ç™½ï¼‰
            const y = seekRect.top - previewHeight - 20; // seekBarã®ä¸Šã«10pxã®éš™é–“

            videoPreview.style.left = `${x}px`;
            videoPreview.style.top = `${y}px`;
        }

        // ã‚¢ã‚¤ã‚³ãƒ³ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤æ›´æ–°
        function updateIconOverlay() {
            if (playlist.length === 0 || 
                (currentVideoIndex >= playlist.length && videoPlayer.paused) || 
                isVideoStopped()) {
                iconOverlay.classList.add('active');
            } else {
                iconOverlay.classList.remove('active');
            }
        }

        // URLå…¥åŠ›æ¬„éè¡¨ç¤º
        function hideURLInputControls() {
            urlControls.style.display = 'none';
            urlInput.style.display = 'none';
            urlConfirmBtn.style.display = 'none';
            urlCancelBtn.style.display = 'none';
            urlInput.value = '';
        }

        // å®šæœŸä¿å­˜é–‹å§‹
        function startPeriodicSave() {
            if (saveInterval) clearInterval(saveInterval);
            saveInterval = setInterval(() => {
                if (!videoPlayer.paused && playlist.length > 0) {
                    localStorage.setItem('currentTime', videoPlayer.currentTime);
                }
            }, 1000);
        }

        // å®šæœŸä¿å­˜åœæ­¢
        function stopPeriodicSave() {
            if (saveInterval) {
                clearInterval(saveInterval);
                saveInterval = null;
            }
        }

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¨å†ç”ŸçŠ¶æ…‹ä¿å­˜
        function savePlaylistAndPlaybackState() {
            if (playlist.length > 0) {
                const playlistPaths = playlist.map(item => item.file.path);
                localStorage.setItem('playlist', JSON.stringify(playlistPaths));
                localStorage.setItem('currentVideoIndex', currentVideoIndex);
                localStorage.setItem('currentTime', videoPlayer.currentTime || 0);
            } else {
                localStorage.removeItem('playlist');
                localStorage.removeItem('currentVideoIndex');
                localStorage.removeItem('currentTime');
                iconOverlay.classList.add('active');
            }
        }

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¡¨ç¤ºæ›´æ–°
        function updatePlaylistDisplay() {
            // videoPlayer ã¯å¸¸ã«å­˜åœ¨ â†’ ãƒã‚§ãƒƒã‚¯ä¸è¦
            const isPlaybackActive = videoPlayer.src !== '';
            filenameDisplay.innerHTML = '';
            if (playlist.length === 0) {
                const savedPlaylist = localStorage.getItem('playlist');
                if (savedPlaylist) {
                    try {
                        const parsedPlaylist = JSON.parse(savedPlaylist);
                        if (Array.isArray(parsedPlaylist) && parsedPlaylist.length > 0) {
                            filenameDisplay.innerHTML = `<option value="">å†ç”Ÿé€”ä¸­:â–¶ï¸ ${parsedPlaylist[currentVideoIndex]}</option>`;
                        } else {
                            filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                            iconOverlay.classList.add('active');
                        }
                    } catch (e) {
                        filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                        iconOverlay.classList.add('active');
                    }
                } else {
                    filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                    iconOverlay.classList.add('active');
                }
                updateIconOverlay();
                return;
            }
            playlist.forEach((item, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = (index === currentVideoIndex && videoPlayerActive ? 'â–¶ï¸ ' : '') + item.name;
                filenameDisplay.appendChild(option);
            });
            filenameDisplay.value = currentVideoIndex;
            updateIconOverlay();
        }

        // å‹•ç”»å†ç”Ÿ
        async function playVideo(file) {
            // å‹•ç”»ã‚½ãƒ¼ã‚¹è¨­å®š
            await setVideoSrc(file);
        
            // å…±é€šå†ç”Ÿå‡¦ç†
            videoPlayer.load();
            videoPreview.load();
            videoPreview.pause();
            videoPlayerActive = true;

            // ãƒœãƒªãƒ¥ãƒ¼ãƒ å¾©å…ƒ
            const savedVolume = localStorage.getItem('volume');
            if (savedVolume && !isNaN(savedVolume) && savedVolume >= 0 && savedVolume <= 1) {
                videoPlayer.volume = savedVolume;
                volumeBar.value = savedVolume;
                lastVolume = savedVolume;
                volumeMuteBtn.textContent = savedVolume == 0 ? 'ğŸ”‡' : 'ğŸ”Š';
                volumeMuteBtn.setAttribute('data-tooltip', savedVolume == 0 ? 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰' : 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
            } else {
                videoPlayer.volume = volumeBar.value || 0.2;
                lastVolume = videoPlayer.volume;
                volumeMuteBtn.textContent = 'ğŸ”Š';
                volumeMuteBtn.setAttribute('data-tooltip', 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
            }
            updateVolumeDisplay();

            if (modeChange === 'convert') {
                // å†ç”Ÿå³çµ‚äº† â†’ æœ€å¾Œå°¾ã¸
                setVideoDurationTime(); // duration ãŒ NaN ã§ã‚‚å®‰å…¨ã«å‡¦ç†
            } else {
                // å†ç”Ÿæ™‚é–“å¾©å…ƒ
                const savedCurrentTime = parseFloat(localStorage.getItem('currentTime'));
                if (!isNaN(savedCurrentTime) && savedCurrentTime >= 0) {
                    videoPlayer.currentTime = savedCurrentTime;
                }
            }

            // å†ç”Ÿé–‹å§‹
            videoPlayer.play().catch(() => {
                playPauseBtn.textContent = 'â–¶ï¸';
                playPauseBtn.setAttribute('data-tooltip', 'å†ç”Ÿï¼ˆSpaceï¼Right Clickï¼‰');
            });
            playPauseBtn.textContent = 'â¸ï¸';
            playPauseBtn.setAttribute('data-tooltip', 'ä¸€æ™‚åœæ­¢ï¼ˆSpaceï¼Right Clickï¼‰');

            startPeriodicSave();
            showControlsAndFilename();
            updatePlaylistDisplay();
            updateIconOverlay();
        }

        // å‹•ç”»ã®ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒãƒ­ãƒ¼ãƒ‰ã•ã‚Œã¦ã‹ã‚‰ currentTime ã‚’æ“ä½œã™ã‚‹ãƒ˜ãƒ«ãƒ‘ãƒ¼
        function setVideoDurationTime() {
            if (videoPlayer.readyState >= 1) { // HAVE_METADATA ä»¥ä¸Š
                videoPlayer.currentTime = videoPlayer.duration;
            } else {
                // ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿ãŒã¾ã ãªã„ â†’ ãƒ­ãƒ¼ãƒ‰å¾Œã«è¨­å®š
                const handler = () => {
                    videoPlayer.currentTime = videoPlayer.duration;
                    videoPlayer.removeEventListener('loadedmetadata', handler);
                };
                videoPlayer.addEventListener('loadedmetadata', handler);
            }
        }

        // å†ç”Ÿ/ä¸€æ™‚åœæ­¢åˆ‡æ›¿
        async function togglePlayPause() {
            videoPlayerActive = true;
            if (videoPlayer.paused) {
                if (isVideoStopped()) {
                    const file = playlist[currentVideoIndex].file;
                    // å‹•ç”»ã‚½ãƒ¼ã‚¹è¨­å®š
                    await setVideoSrc(file);

                    // å…±é€šå†ç”Ÿå‡¦ç†
                    videoPlayer.load();
                    videoPreview.load();
                    videoPreview.pause();
                    updatePlaylistDisplay();
                }

                if (modeChange === 'convert') {
                    // å†ç”Ÿå³çµ‚äº† â†’ æœ€å¾Œå°¾ã¸
                    setVideoDurationTime(); // duration ãŒ NaN ã§ã‚‚å®‰å…¨ã«å‡¦ç†
                }
                
                videoPlayer.play().catch(() => {
                    playPauseBtn.textContent = 'â–¶ï¸';
                    playPauseBtn.setAttribute('data-tooltip', 'å†ç”Ÿï¼ˆSpaceï¼Right Clickï¼‰');
                    updateIconOverlay();
                });
                playPauseBtn.textContent = 'â¸ï¸';
                playPauseBtn.setAttribute('data-tooltip', 'ä¸€æ™‚åœæ­¢ï¼ˆSpaceï¼Right Clickï¼‰');
                startPeriodicSave();
            } else {
                videoPlayer.pause();
                playPauseBtn.textContent = 'â–¶ï¸';
                playPauseBtn.setAttribute('data-tooltip', 'å†ç”Ÿï¼ˆSpaceï¼Right Clickï¼‰');
                localStorage.setItem('currentTime', videoPlayer.currentTime);
                stopPeriodicSave();
            }
            showControlsAndFilename();
            updateIconOverlay();
        }

        // å‹•ç”»ã‚½ãƒ¼ã‚¹è¨­å®š
        async function setVideoSrc(file) {
            const ext = path.extname(file.path).toLowerCase();

            // HTML5 ãƒã‚¤ãƒ†ã‚£ãƒ–å¯¾å¿œ
            if (isHTML5_SUPPORTED(ext)) {
                videoPlayer.src = file.path;
                videoPreview.src = videoPlayer.src;
            } 
            // éå¯¾å¿œ â†’ FFmpegå¤‰æ›
            else {
                videoPlayer.src = '';
                videoPreview.src = videoPlayer.src;
                if (isConverting) {
                    updateOverlayDisplay('å¤‰æ›ä¸­â€¦ ã—ã°ã‚‰ããŠå¾…ã¡ãã ã•ã„');
                    return;
                }

                updatePlaylistDisplay();
                try {
                    isConverting = true;
                    updateOverlayDisplay('å¤‰æ›ä¸­â€¦ï¼ˆFFmpegï¼‰');
                    currentConvertPromise = ipcRenderer.invoke('convert-video', file.path);
                    const convertedPath = await currentConvertPromise;
        
                    const response = await fetch(`file://${convertedPath}`);
                    const blob = await response.blob();
                    const blobUrl = URL.createObjectURL(blob);
        
                    videoPlayer.src = blobUrl;
                    videoPreview.src = videoPlayer.src;
                    isConverting = false;
        
                    if (modeChange === 'video') {
                        // ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
                        videoPlayer.onloadedmetadata = () => {
                            if (convertedPath) {
                                ipcRenderer.invoke('delete-temp-file', convertedPath)
                                    .catch(e => console.warn('ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤å¤±æ•—:', e));
                            }
                            const revoke = () => {
                                URL.revokeObjectURL(blobUrl);
                                videoPlayer.removeEventListener('ended', revoke);
                                videoPlayer.removeEventListener('error', revoke);
                            };
                            videoPlayer.addEventListener('ended', revoke);
                            videoPlayer.addEventListener('error', revoke);
                        };
                    } else if (modeChange === 'convert') {
                        // å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤
                        videoPlayer.onloadedmetadata = () => {
                            if (file.path) {
                                ipcRenderer.invoke('delete-temp-file', file.path)
                                    .catch(e => console.warn('å‹•ç”»ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤å¤±æ•—:', e));
                            }
                            const revoke = () => {
                                URL.revokeObjectURL(blobUrl);
                                videoPlayer.removeEventListener('ended', revoke);
                                videoPlayer.removeEventListener('error', revoke);
                            };
                            videoPlayer.addEventListener('ended', revoke);
                            videoPlayer.addEventListener('error', revoke);
                        };
                        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆæ›´æ–°
                        const currentIndex = playlist.findIndex(item => item.file.path === file.path);
                        if (currentIndex !== -1) {
                            // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®è©²å½“ã‚¨ãƒ³ãƒˆãƒªã‚’æ›´æ–°
                            playlist[currentIndex] = {
                                file: { path: convertedPath },
                                name: convertedPath
                            };
                            // å¿…è¦ã«å¿œã˜ã¦ UI ã®ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¡¨ç¤ºã‚‚æ›´æ–°ï¼ˆä¾‹: å†æç”»ï¼‰
                            updatePlaylistDisplay();
                        }
                    }
                } catch (err) {
                    console.error("å¤‰æ›å¤±æ•—:", err);
                    isConverting = false;
                    updateOverlayDisplay(`å¤‰æ›å¤±æ•—`);
                    filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                    iconOverlay.classList.add('active');
                    setTimeout(hideOverlayDisplay, 3000);
                    return;
                }
            }
        }

        // å‹•ç”»ï¼åœæ­¢ä¸­åˆ¤å®š
        function isVideoStopped() {
            return videoPlayer.paused && 
                   playlist.length > 0 && 
                   !Array.from(filenameDisplay.options).some(option => option.text.includes('â–¶ï¸'));
        }

        // Urlå†ç”Ÿå®Œæˆ
        function urlInputEnter() {
            const url = urlInput.value.trim();
            if (!url) {
                updateOverlayDisplay('å‹•ç”»ã®URLã‚’å…¥åŠ›ã—ã¦ãã ã•ã„');
                updateIconOverlay();
                return;
            }

            const platform = isTwitchOrYouTube(url);
            let playlistId = null;
            let videoId = null;
            let videoUrl = null;

            if (platform === 'Twitch') {
                videoId = extractTwitchVideoId(url);
                if (!videoId) {
                    updateOverlayDisplay('ç„¡åŠ¹ãªTwitch URLã§ã™ã€‚');
                    updateIconOverlay();
                    return;
                }
                videoUrl = `https://player.twitch.tv/?video=${videoId}&parent=twitch.tv&player=popout`;
            } else if (platform === 'YouTube') {
                playlistId = extractYouTubePlaylistId(url);
                videoId = extractYouTubeVideoId(url);
                if (!videoId && !playlistId) {
                    updateOverlayDisplay('ç„¡åŠ¹ãªYouTube URLã§ã™ã€‚');
                    updateIconOverlay();
                    return;
                }
                if (youtubeAdd === 'embed') {
                    videoUrl = `https://www.youtube.com/embed/${videoId}?autoplay=1&controls=1&cc_load_policy=0`;
                } else if (youtubeAdd === 'normal') {
                    videoUrl = `https://www.youtube.com/watch?v=${videoId}?autoplay=1&cc_load_policy=0`;
                }
                if (playlistId) {
                    if (youtubeAdd === 'embed') {
                        videoUrl = `https://www.youtube.com/embed/videoseries?list=${playlistId}&autoplay=1&controls=1&cc_load_policy=0`;
                    } else if (youtubeAdd === 'normal') {
                        videoUrl = `https://www.youtube.com/watch?v=${videoId}&list=${playlistId}&autoplay=1`;
                    }
                }
            } else if (platform === 'Other') {
                videoUrl = url;
            } else {
                updateOverlayDisplay('ç„¡åŠ¹ãªURLã§ã™ã€‚');
                updateIconOverlay();
                return;
            }

            try {
                const command = `${application} --profile-directory=Default --app="${videoUrl}"`;
                exec(command);

                console.log("å†ç”Ÿå‹•ç”»>", command);

                hideURLInputControls();
                filenameControls.style.display = 'flex';
                showControlsAndFilename();
                updateIconOverlay();
            } catch (error) {
                console.error('YouTube Or Twitch Player Setup Error:', error.message, error.stack);
                updateOverlayDisplay(`å‹•ç”»ãƒ—ãƒ¬ãƒ¼ãƒ¤ãƒ¼ã®è¨­å®šã«å¤±æ•—ã—ã¾ã—ãŸï¼ˆ${error.message}ï¼‰ã€‚åˆ¥ã®å‹•ç”»ã‚’è©¦ã—ã¦ãã ã•ã„ã€‚`);
                updateIconOverlay();
            }
        }

        // Urlå…¥åŠ›ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        function urlInputCancel() {
            hideURLInputControls();
            filenameControls.style.display = 'flex';
            showControlsAndFilename();
            updateIconOverlay();
        }

        // å‹•ç”»ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ åˆ¤å®š
        function isTwitchOrYouTube(url) {
            if (url.includes('http')) {
                if (url.includes('twitch.tv')) {
                    if (url.includes('videos')) {
                        return 'Twitch';
                    } else {              
                        return 'Other';
                    }
                } else if (url.includes('youtube.com') || url.includes('youtu.be')) {
                    return 'YouTube';
                }
            }
            return null;
        }
    
        // Twitchå‹•ç”»IDæŠ½å‡º
        function extractTwitchVideoId(url) {
            const regex = /twitch\.tv\/videos\/(\d+)/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // YouTubeå‹•ç”»ãƒªã‚¹ãƒˆIDæŠ½å‡º
        function extractYouTubePlaylistId(url) {
            const regex = /[?&]list=([^&#]+)/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // YouTubeå‹•ç”»IDæŠ½å‡º
        function extractYouTubeVideoId(url) {
            const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?|shorts)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = url.match(regex);
            return match ? match[1] : null;
        }

        // ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰è²¼ã‚Šä»˜ã‘å‡¦ç†
        async function handlePaste() {
            try {
                const pastedText = await pasteFromClipboard();
            } catch (err) {
                console.error(err.message);
            }
        }

        // ãƒ˜ãƒ«ãƒ—ã‚’é–‹ã
        function openHelp() {
            videoContainer.style.display = 'none';
            helpContainer.style.display = 'block';
            helpTitle.textContent = `${appName}ã®æ“ä½œ`;
            isHelpOpen = true;
        }

        // ãƒ˜ãƒ«ãƒ—ã‚’é–‰ã˜ã‚‹
        function closeHelp() {
            videoContainer.style.display = 'flex';
            helpContainer.style.display = 'none';
            isHelpOpen = false;
            showControlsAndFilename();
            updateIconOverlay();
        }

        // ãƒ•ã‚©ãƒ«ãƒ€è¨­å®š
        async function folderInputSet(videoFiles) {
            if (videoFiles.length > 0) {
                // FFmpegå¤‰æ›ä¸­æ–­
                if (isConverting) {
                    await ipcRenderer.invoke('cancel-conversion');  // å³ä¸­æ–­
                    isConverting = false;
                    setTimeout(hideOverlayDisplay, 1000);
                }
        
                playlist = videoFiles.map(file => ({
                    file: { path: file.path },
                    name: file.path
                }));
                // playlist.sort((a, b) => a.name.localeCompare(b.name));
    
                currentVideoIndex = 0;
                localStorage.setItem('currentTime', 0);
    
                updatePlaylistDisplay();
                playVideo(playlist[currentVideoIndex].file);
                savePlaylistAndPlaybackState();
                updateIconOverlay();
            } else {
                iconOverlay.classList.add('active');
            }
        }

        // ãƒ•ã‚¡ã‚¤ãƒ«è¨­å®š
        async function videoInputSet(videoFiles) {
            if (videoFiles.length > 0) {
                // FFmpegå¤‰æ›ä¸­æ–­
                if (isConverting) {
                    await ipcRenderer.invoke('cancel-conversion');  // å³ä¸­æ–­
                    isConverting = false;
                    setTimeout(hideOverlayDisplay, 1000);
                }
        
                playlist = videoFiles.map(file => ({
                    file: { path: file.path },
                    name: file.path
                }));
    
                currentVideoIndex = 0;
                localStorage.setItem('currentTime', 0);
    
                updatePlaylistDisplay();
                playVideo(playlist[currentVideoIndex].file);
                savePlaylistAndPlaybackState();
                updateIconOverlay();
            } else {
                iconOverlay.classList.add('active');
            }
        }

        // HTML5å¯¾å¿œæ‹¡å¼µå­åˆ¤å®š
        function isHTML5_SUPPORTED(ext) {
            if (modeChange === 'video') {
                return HTML5_SUPPORTED.includes(ext.toLowerCase());
            } else {
                return HTML5_SUPPORTED_CONVERT.includes(ext.toLowerCase());
            }
        }

        // ä¸Šã¸ç§»å‹•
        function upMovePlaylist() {
            const currentIndex = parseInt(filenameDisplay.value);
            if (isNaN(currentIndex) || currentIndex <= 0 || playlist.length === 0) return;
        
            // é…åˆ—ã‹ã‚‰ç§»å‹•
            const [movedItem] = playlist.splice(currentIndex, 1);
            playlist.splice(currentIndex - 1, 0, movedItem);
        
            // å†ç”Ÿä¸­ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå½±éŸ¿ã‚’å—ã‘ã‚‹å ´åˆã®èª¿æ•´
            if (currentVideoIndex === currentIndex) {
                currentVideoIndex -= 1;
            } 
        
            updatePlaylistDisplay();
            savePlaylistAndPlaybackState();
        }
        
        // ä¸‹ã¸ç§»å‹•
        function downMovePlaylist() {
            const currentIndex = parseInt(filenameDisplay.value);
            if (isNaN(currentIndex) || currentIndex >= playlist.length - 1 || playlist.length === 0) return;
        
            // é…åˆ—ã‹ã‚‰ç§»å‹•
            const [movedItem] = playlist.splice(currentIndex, 1);
            playlist.splice(currentIndex + 1, 0, movedItem);
        
            // å†ç”Ÿä¸­ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ãŒå½±éŸ¿ã‚’å—ã‘ã‚‹å ´åˆã®èª¿æ•´
            if (currentVideoIndex === currentIndex) {
                currentVideoIndex += 1;
            } 
        
            updatePlaylistDisplay();
            savePlaylistAndPlaybackState();
        }

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆè¿½åŠ 
        async function addToPlaylist() {
            try {
                const files = await ipcRenderer.invoke('open-video-dialog');
                if (!files || files.length === 0) return;
        
                const newFiles = [];
                for (const file of files) {
                    newFiles.push({ path: file.path, name: file.path });
                }
        
                if (newFiles.length > 0) {
                    // ç¾åœ¨ã®é¸æŠä½ç½®ï¼ˆæŒ¿å…¥ä½ç½®ï¼‰
                    let insertIndex = parseInt(filenameDisplay.value);
                    if (isNaN(insertIndex) || insertIndex < 0 || insertIndex >= playlist.length) {
                        insertIndex = playlist.length; // ç„¡åŠ¹ãªé¸æŠ â†’ æœ«å°¾
                    } else {
                        insertIndex += 1; // é¸æŠè¡Œã®ã€Œä¸‹ã€ã«æŒ¿å…¥
                    }

                    // ä¿®æ­£ç‚¹ï¼šinsertIndex ã®ä½ç½®ã« newFiles ã‚’æŒ¿å…¥
                    const formattedFiles = newFiles.map(f => ({ file: { path: f.path }, name: f.name }));
                    playlist.splice(insertIndex, 0, ...formattedFiles);
        
                    if (filenameDisplay.index < 0) {
                        filenameDisplay.index = 0;
                    }

                    updatePlaylistDisplay();
                    savePlaylistAndPlaybackState();
                    showControlsAndFilename();
                }
            } catch (e) {
                console.error('è¿½åŠ ã‚¨ãƒ©ãƒ¼:', e);
                updateOverlayDisplay('å‹•ç”»è¿½åŠ ã«å¤±æ•—');
                setTimeout(hideOverlayDisplay, 2000);
            }
        }

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆå‰Šé™¤
        async function removeFromPlaylist() {
            const selectedIndex = parseInt(filenameDisplay.value);
            if (isNaN(selectedIndex) || selectedIndex < 0 || selectedIndex >= playlist.length) {
                updateOverlayDisplay('å‰Šé™¤ã™ã‚‹å‹•ç”»ã‚’é¸æŠã—ã¦ãã ã•ã„');
                setTimeout(hideOverlayDisplay, 2000);
                return;
            }

            // FFmpegå¤‰æ›ä¸­æ–­
            if (isConverting) {
                await ipcRenderer.invoke('cancel-conversion');  // å³ä¸­æ–­
                isConverting = false;
                setTimeout(hideOverlayDisplay, 1000);
            }
            
            // å†ç”Ÿä¸­ã‹ã©ã†ã‹ã®åˆ¤å®š
            const isCurrentlyPlaying = currentVideoIndex === selectedIndex && !videoPlayer.paused;
        
            // å‰Šé™¤å®Ÿè¡Œ
            playlist.splice(selectedIndex, 1);
        
            // æ–°ã—ã„ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’è¨ˆç®—
            let newIndex;
            if (selectedIndex < playlist.length) {
                // æ¬¡ãŒã‚ã‚‹ â†’ æ¬¡ã‚’é¸æŠ
                newIndex = selectedIndex;
            } else {
                // æ¬¡ãŒãªã„ï¼ˆæœ€çµ‚è¡Œï¼‰â†’ å‰ã‚’é¸æŠ
                newIndex = Math.max(0, playlist.length - 1);
            }

            if (playlist.length > 0) {
                // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã«å‹•ç”»ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€‚
                if (isCurrentlyPlaying) {
                    // å‹•ç”»ãŒå†ç”Ÿä¸­ã®å ´åˆã€‚
                    if (selectedIndex < playlist.length) {
                        // æ¬¡å‹•ç”»ãŒå­˜åœ¨ã™ã‚‹å ´åˆã€‚
                        currentVideoIndex = newIndex;
                        updatePlaylistDisplay();
                        playVideo(playlist[currentVideoIndex].file);
                    } else {
                        // æ¬¡å‹•ç”»ãŒå­˜åœ¨ã—ãªã„ï¼ˆãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®æœ€å¾Œï¼‰å ´åˆã€‚
                        currentVideoIndex = newIndex;
                        updatePlaylistDisplay();
                        playStopBtn.click();
                        filenameDisplay.value = currentVideoIndex;
                    }
                } else {
                    // å‹•ç”»ãŒåœæ­¢ã®å ´åˆã€‚
                    currentVideoIndex = newIndex;
                    updatePlaylistDisplay();
                    playStopBtn.click();
                    filenameDisplay.value = currentVideoIndex;
                } 
            } else {
                // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãŒç©ºã«ãªã£ãŸå ´åˆ
                filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
                iconOverlay.classList.add('active');
                playStopBtn.click();
            }
            savePlaylistAndPlaybackState();
            showControlsAndFilename();
        }

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã‚¯ãƒªã‚¢
        async function clearPlaylist() {
            if (playlist.length === 0) return;
            // FFmpegå¤‰æ›ä¸­æ–­
            if (isConverting) {
                await ipcRenderer.invoke('cancel-conversion');  // å³ä¸­æ–­
                isConverting = false;
                setTimeout(hideOverlayDisplay, 1000);
            }
        
            // å†ç”Ÿä¸­ã®å‹•ç”»ã‚’åœæ­¢
            filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
            iconOverlay.classList.add('active');
            playStopBtn.click();
        
            // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã¨çŠ¶æ…‹ã‚’ã‚¯ãƒªã‚¢
            playlist.length = 0;
            currentVideoIndex = -1;
        
            // UIã¨çŠ¶æ…‹ã‚’æ›´æ–°
            // updatePlaylistDisplay();
            savePlaylistAndPlaybackState();
            showControlsAndFilename();
        }
        
        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆä¿å­˜
        async function savePlaylist() {
            if (playlist.length === 0) {
                updateOverlayDisplay('ä¿å­˜ã™ã‚‹å‹•ç”»ãŒã‚ã‚Šã¾ã›ã‚“');
                setTimeout(hideOverlayDisplay, 2000);
                return;
            }
        
            // å¸¸ã«ä¿å­˜ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ã‚’è¡¨ç¤º
            const result = await ipcRenderer.invoke('save-playlist-dialog');
            if (result.canceled) {
                return; // ã‚­ãƒ£ãƒ³ã‚»ãƒ« â†’ ä½•ã‚‚ã—ãªã„
            }
        
            const savePath = result.filePath;
        
            try {
                const paths = playlist.map(item => item.file.path);
                const content = paths.join('\n');
                fs.writeFileSync(savePath, content, 'utf-8');
        
                updateOverlayDisplay(`ğŸ’¾: ${path.basename(savePath)}`);
                setTimeout(hideOverlayDisplay, 2000);
            } catch (e) {
                console.error('ä¿å­˜ã‚¨ãƒ©ãƒ¼:', e);
                updateOverlayDisplay('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ');
                setTimeout(hideOverlayDisplay, 2000);
            }
        }

        // ğŸ”²ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆğŸ”²
        // main.js ã‹ã‚‰ã®è‡ªå‹•å†ç”ŸæŒ‡ç¤ºã‚’å—ä¿¡
        ipcRenderer.on('auto-play-files', async (event, videoFiles) => {
            if (!videoFiles || videoFiles.length === 0) return;
        
            let isFolderMode = videoFiles.length > 1;
            if (videoFiles.length === 1) {
                try {
                    const stat = await fs.promises.stat(videoFiles[0].path);
                    isFolderMode = stat.isDirectory();
                } catch (e) {
                    console.warn("ãƒ•ã‚©ãƒ«ãƒ€åˆ¤å®šå¤±æ•—:", e);
                    isFolderMode = false;
                }
            }
            if (isFolderMode) {
                folderInputSet(videoFiles);
            } else {
                videoInputSet(videoFiles);
            }
        });

        // å¤‰æ›é€²æ—å—ä¿¡
        ipcRenderer.on('convert-progress', (event, { percent }) => {
            updateOverlayDisplay(`å¤‰æ›ä¸­â€¦ ${Math.round(percent)}%`);
        });
    
        // å¤‰æ›ã‚¨ãƒ©ãƒ¼
        ipcRenderer.on('convert-error', (event, msg) => {
            console.error("å¤‰æ›å¤±æ•—:", err);
            isConverting = false;
            updateOverlayDisplay(`å¤‰æ›å¤±æ•—`);
            filenameDisplay.innerHTML = `<option value="">${appNameAndCopyrightValue}</option>`;
            iconOverlay.classList.add('active');
            setTimeout(hideOverlayDisplay, 3000);
        });

        // ğŸ”²ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¤ãƒ™ãƒ³ãƒˆğŸ”²
        // ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒªã‚µã‚¤ã‚º
        window.addEventListener('resize', () => {
            const autoSize = calculateControlSize();
            sizeSelect.value = autoSize;
            localStorage.setItem('controlSize', autoSize);
            updateControlSize(autoSize);
            showControlsAndFilename();
            updateIconOverlay();
        });

        // ã‚­ãƒ¼å…¥åŠ›ï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ï¼‰
        document.addEventListener('keydown', (event) => {
            if (isHelpOpen) {
                if (event.key === 'Escape') {
                    event.preventDefault();
                    closeHelp();
                } else {
                    event.preventDefault();
                }
                return;
            }

            // ğŸŒUrlå…¥åŠ›çŠ¶æ…‹
            if (urlInput.style.display === 'inline-block' && urlInput === document.activeElement) {
                // âœ…Urlå…¥åŠ›ç¢ºå®šï¼ˆEnterï¼‰
                if (event.key === 'Enter') {
                    event.preventDefault();
                    urlInputEnter();
                    return;
                }
                
                // âŒUrlå…¥åŠ›ã‚­ãƒ£ãƒ³ã‚»ãƒ«ï¼ˆEscapeï¼‰
                if (event.key === 'Escape') {
                    event.preventDefault();
                    urlInputCancel();
                    return;
                }
            }

            // â“ãƒ˜ãƒ«ãƒ—é–‹ãï¼ˆCtrl+hï¼‰
            if (event.ctrlKey && event.key === 'h') {
                event.preventDefault();
                openHelp();
                return;
            }

            // ğŸ¬ï¼ğŸ”„ï¸ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠï¼ˆCtrl+rï¼‰
            if (event.ctrlKey && event.key === 'v') {
                event.preventDefault();
                modeChangeBtn.click();
                return;
            }

            // ğŸŒãƒãƒƒãƒˆå‹•ç”»é¸æŠï¼ˆCtrl+nï¼‰
            if (event.ctrlKey && event.key === 'n') {
                event.preventDefault();
                urlInputBtn.click();
                return;
            }

            // ğŸ“ãƒ•ã‚©ãƒ«ãƒ€é¸æŠï¼ˆCtrl+dï¼‰
            if (event.ctrlKey && event.key === 'd') {
                event.preventDefault();
                folderInput.click();
                return;
            }

            // ğŸ—’ï¸ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠï¼ˆCtrl+fï¼‰
            if (event.ctrlKey && event.key === 'f') {
                event.preventDefault();
                videoInput.click();
                return;
            }

            // â®ï¸å‰ã®å‹•ç”»ã¸ï¼ˆPgUpï¼‰
            if (event.key === 'PageUp' && playlist.length > 0) {
                event.preventDefault();
                prevVideoBtn.click();
                return;
            } 

            // âª30ç§’æˆ»ã‚‹ï¼ˆCtrl+â†ï¼Swipe Leftï¼‰
            if (event.ctrlKey && event.key === 'ArrowLeft') {
                event.preventDefault();
                rewindBtn.click();
                return;
            } 

            // â–¶ï¸å†ç”Ÿï¼â¸ï¸ä¸€æ™‚åœæ­¢ï¼ˆSpaceï¼Right Clickï¼‰
            if (!event.ctrlKey && event.key === ' ') {
                event.preventDefault();
                playPauseBtn.click();
                return;
            }

            // â¹ï¸åœæ­¢ï¼ˆCtrl+Spaceï¼Ctrl+Right Clickkï¼‰
            if (event.ctrlKey && event.key === ' ') {
                event.preventDefault();
                playStopBtn.click();
                return;
            } 

            // â©30ç§’é€²ã‚€ï¼ˆCtrl+â†’ï¼Swipe Rightï¼‰
            if (event.ctrlKey && event.key === 'ArrowRight') {
                event.preventDefault();
                fastForwardBtn.click();
                return;
            } 

            // â­ï¸æ¬¡ã®å‹•ç”»ã¸ï¼ˆPgDwï¼‰
            if (event.key === 'PageDown' && playlist.length > 0) {
                event.preventDefault();
                nextVideoBtn.click();
                return;
            }

            // â†”ï¸æ¨ªã«åˆã‚ã›ã‚‹ï¼â†•ï¸ç¸¦ã«åˆã‚ã›ã‚‹ï¼ˆCtrl+xï¼‰
            if (event.ctrlKey && event.key === 'x') {
                event.preventDefault();
                fitModeBtn.click();
                return;
            }

            // ã‚µã‚¤ã‚ºå¤‰æ›´ï¼ˆCtrl+sï¼‰
            if (event.ctrlKey && event.key === 's') {
                event.preventDefault(); // ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œï¼ˆä¿å­˜ãƒ€ã‚¤ã‚¢ãƒ­ã‚°ãªã©ï¼‰ã‚’é˜²æ­¢
                const sizes = [100, 75, 50, 25, 10];
                const currentSize = parseInt(sizeSelect.value);
                const currentIndex = sizes.indexOf(currentSize);
                const nextIndex = (currentIndex + 1) % sizes.length; // æ¬¡ã®ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆå¾ªç’°ï¼‰
                sizeSelect.value = sizes[nextIndex]; // æ¬¡ã®ã‚µã‚¤ã‚ºã«å¤‰æ›´
                sizeSelect.dispatchEvent(new Event('change')); // changeã‚¤ãƒ™ãƒ³ãƒˆã‚’ãƒˆãƒªã‚¬ãƒ¼
                return;
            }

            // ğŸ–¥ï¸ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºï¼âŒãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è§£é™¤ï¼ˆCtrl+zï¼Double Clickï¼‰
            if (event.ctrlKey && event.key === 'z') {
                event.preventDefault();
                fullscreenBtn.click();
                return;
            }

            // ğŸ”ŠãƒŸãƒ¥ãƒ¼ãƒˆï¼ğŸ”‡ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰
            if (event.ctrlKey && event.key === 'm') {
                event.preventDefault();
                volumeMuteBtn.click();
                return;
            }

            // éŸ³é‡å¤‰æ›´ï¼ˆâ†“ï¼â†‘ï¼‰
            if (event.key === 'ArrowUp' || event.key === 'ArrowDown') {
                const delta = event.key === 'ArrowUp' ? 0.05 : -0.05;
                videoPlayer.volume = Math.max(0, Math.min(1, videoPlayer.volume + delta));
                volumeBar.value = videoPlayer.volume;
                lastVolume = videoPlayer.volume;
                volumeMuteBtn.textContent = videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š';
                volumeMuteBtn.setAttribute('data-tooltip', videoPlayer.volume === 0 ? 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰' : 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
                updateVolumeDisplay();
                updateOverlayDisplay(`${videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š'} ${Math.round(videoPlayer.volume * 100)}%`);
                localStorage.setItem('volume', videoPlayer.volume);
                showControlsAndFilename();
                updateIconOverlay();
                return;
            }
            
            // 5ç§’æˆ»ã‚‹ï¼5ç§’é€²ã‚€ï¼ˆâ†ï¼â†’ï¼‰
            if (event.key === 'ArrowLeft' || event.key === 'ArrowRight') {
                if (videoPlayer.duration) {
                    wasPlaying = !videoPlayer.paused;
                    const delta = event.key === 'ArrowLeft' ? -5 : 5;
                    let newTime = videoPlayer.currentTime + delta;
                    newTime = Math.max(0, Math.min(videoPlayer.duration, newTime));
                    videoPlayer.currentTime = newTime;
                    seekBar.value = (100 / videoPlayer.duration) * newTime;
                    updateTimeDisplay();
                    updateOverlayDisplay(`ğŸ•“ ${formatTime(newTime)}`);
                    localStorage.setItem('currentTime', newTime);
                    showControlsAndFilename();
                    updateIconOverlay();
                }
                return;
            } 
            
            // å…ˆé ­å‹•ç”»å†ç”Ÿï¼ˆHomeï¼‰
            if (event.key === 'Home' && playlist.length > 0) {
                currentVideoIndex = 0;
                localStorage.setItem('currentTime', 0);
                updatePlaylistDisplay();
                playVideo(playlist[currentVideoIndex].file);
                savePlaylistAndPlaybackState();
                showControlsAndFilename();
                updateIconOverlay();
                return;
            }
            
            // æœ€çµ‚å‹•ç”»å†ç”Ÿï¼ˆEndï¼‰
            if (event.key === 'End' && playlist.length > 0) {
                currentVideoIndex = playlist.length - 1;
                localStorage.setItem('currentTime', 0);
                updatePlaylistDisplay();
                playVideo(playlist[currentVideoIndex].file);
                savePlaylistAndPlaybackState();
                showControlsAndFilename();
                updateIconOverlay();
                return;
            }

            // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«è¡¨ç¤ºï¼éè¡¨ç¤ºï¼ˆCtrl+cï¼Clickï¼‰
            if (event.ctrlKey && event.key === 'c') {
                event.preventDefault();
                videoPlayer.click();
                return;
            }

            // YouTubeç”Ÿæˆã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆCtrl+yï¼‰
            if (event.ctrlKey && event.key === 'y') {
                // é€šå¸¸ï¼šnormalï¼åŸ‹ã‚è¾¼ã¿ï¼šembed
                if (youtubeAdd === 'embed') {
                    urlInputBtn.classList.remove('embed-active');
                    youtubeAdd = 'normal';
                } else {
                    urlInputBtn.classList.add('embed-active');
                    youtubeAdd = 'embed';
                }
                localStorage.setItem('youtubeAdd', youtubeAdd);
                return;
            }
        });

        // ã‚°ãƒ­ãƒ¼ãƒãƒ« mouseup ã§ãƒ‰ãƒ©ãƒƒã‚°çµ‚äº†ã‚’ç¢ºå®Ÿã«æ¤œçŸ¥
        document.addEventListener('mouseup', (e) => {
            if (isSeekDragging) {
                isSeekDragging = false;
                isDragging = false;
                darkOverlay.style.display = 'none';
                hideOverlayDisplay();
                
                if (videoPlayer.duration) {
                    const time = videoPlayer.duration * (seekBar.value / 100);
                    videoPlayer.currentTime = time;
                    updateTimeDisplay();
                    localStorage.setItem('currentTime', time);
                }
        
                if (isMouseOverSeekBar) {
                    videoPreview.style.display = 'block';
                }
            }
        });

        // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³å¤‰æ›´
        document.addEventListener('fullscreenchange', () => {
            if (!document.fullscreenElement) {
                fullscreenBtn.textContent = 'ğŸ–¥ï¸';
                fullscreenBtn.setAttribute('data-tooltip', 'ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºï¼ˆCtrl+zï¼Double Clickï¼‰');
            } else {
                fullscreenBtn.textContent = 'âŒ';
                fullscreenBtn.setAttribute('data-tooltip', 'ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è§£é™¤ï¼ˆCtrl+zï¼Double Clickï¼‰');
            }
            updateIconOverlay();
        });

        // ğŸ”²ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ğŸ”²
        // ãƒãƒƒãƒˆå‹•ç”»é¸æŠ
        urlInputBtn.addEventListener('click', async () => {
            await handlePaste();
            if (!urlInput.value) {
                filenameControls.style.display = 'none';
                urlControls.style.display = 'flex';
                urlInput.style.display = 'inline-block';
                urlConfirmBtn.style.display = 'inline-block';
                urlCancelBtn.style.display = 'inline-block';
                urlInput.focus();
                showControlsAndFilename();
                updateIconOverlay();
            } else {
                urlInputEnter();
            }
        });

        // ãƒ•ã‚©ãƒ«ãƒ€é¸æŠ
        folderInput.addEventListener('click', async () => {
            hideOverlayDisplay();
            try {
                const videoFiles = await ipcRenderer.invoke('open-folder-dialog');
                folderInputSet(videoFiles);
            } catch (e) {
                updateOverlayDisplay('ãƒ•ã‚©ãƒ«ãƒ€é¸æŠã‚¨ãƒ©ãƒ¼');
                console.error('ãƒ•ã‚©ãƒ«ãƒ€é¸æŠã‚¨ãƒ©ãƒ¼:', e);
                iconOverlay.classList.add('active');
            }
        });
        
        // ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠ
        videoInput.addEventListener('click', async () => {
            hideOverlayDisplay();
            try {
                const videoFiles = await ipcRenderer.invoke('open-video-dialog');
                videoInputSet(videoFiles);
            } catch (e) {
                updateOverlayDisplay('ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚¨ãƒ©ãƒ¼');
                console.error('ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠã‚¨ãƒ©ãƒ¼:', e);
                iconOverlay.classList.add('active');
            }
        });

        // å‹•ä½œãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿ï¼ˆè¦–è´ï¼å¤‰æ›ï¼‰
        modeChangeBtn.addEventListener('click', () => {
            if (modeChange === 'convert') {
                modeChange = 'video';
                modeChangeBtn.classList.remove('convert-active');
            } else {
                modeChange = 'convert';
                modeChangeBtn.classList.add('convert-active');
            }
            modeChangeBtn.textContent = modeChange === 'video' ? 'ğŸ¬' : 'ğŸ”„ï¸';
            modeChangeBtn.setAttribute('data-tooltip', modeChange === 'video' ? 'è¦–è´ãƒ¢ãƒ¼ãƒ‰ï¼ˆCtrl+vï¼‰' : 'å¤‰æ›ãƒ¢ãƒ¼ãƒ‰ï¼ˆCtrl+vï¼‰');
            localStorage.setItem('modeChange', modeChange);
        });
        
        // URLå†ç”Ÿ
        urlConfirmBtn.addEventListener('click', () => {
            urlInputEnter();
        });

        // URLå…¥åŠ›ã‚­ãƒ£ãƒ³ã‚»ãƒ«
        urlCancelBtn.addEventListener('click', () => {
            urlInputCancel();
        });

        // å†ç”Ÿ/ä¸€æ™‚åœæ­¢
        playPauseBtn.addEventListener('click', togglePlayPause);

        // å†ç”Ÿåœæ­¢
        playStopBtn.addEventListener('click', async () => {
            const options = filenameDisplay.options;
            
            videoPlayer.pause();
            playPauseBtn.textContent = 'â–¶ï¸';
            playPauseBtn.setAttribute('data-tooltip', 'å†ç”Ÿï¼ˆSpaceï¼Right Clickï¼‰');
            videoPlayer.src = '';
            videoPreview.src = videoPlayer.src;         // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚‚è§£æ”¾
            videoPlayer.load();
            videoPreview.load();
            for (let i = 0; i < options.length; i++) {
                options[i].text = options[i].text.replace('â–¶ï¸ ', '');
            }
            videoPlayerActive = false;
            stopPeriodicSave();
            showControlsAndFilename();
            updateIconOverlay();
        
            // FFmpegå¤‰æ›ä¸­æ–­
            if (isConverting) {
                await ipcRenderer.invoke('cancel-conversion');
                isConverting = false;
                setTimeout(hideOverlayDisplay, 1000);
            }
        });

        // å‰ã®å‹•ç”»
        prevVideoBtn.addEventListener('click', () => {
            if (currentVideoIndex > 0) {
                currentVideoIndex--;
                localStorage.setItem('currentTime', 0);
                updatePlaylistDisplay();
                playVideo(playlist[currentVideoIndex].file);
                savePlaylistAndPlaybackState();
                updateIconOverlay();
            }
            showControlsAndFilename();
        });

        // 30ç§’æˆ»ã‚‹
        rewindBtn.addEventListener('click', () => {
            if (videoPlayer.duration) {
                wasPlaying = !videoPlayer.paused;
                let newTime = videoPlayer.currentTime - 30;
                newTime = Math.max(0, newTime);
                videoPlayer.currentTime = newTime;
                seekBar.value = (100 / videoPlayer.duration) * newTime;
                updateTimeDisplay();
                updateOverlayDisplay(`ğŸ•“ ${formatTime(newTime)}`);
                localStorage.setItem('currentTime', newTime);
                showControlsAndFilename();
                updateIconOverlay();
            }
        });

        // 30ç§’é€²ã‚€
        fastForwardBtn.addEventListener('click', () => {
            if (videoPlayer.duration) {
                wasPlaying = !videoPlayer.paused;
                let newTime = videoPlayer.currentTime + 30;
                newTime = Math.min(videoPlayer.duration, newTime);
                videoPlayer.currentTime = newTime;
                seekBar.value = (100 / videoPlayer.duration) * newTime;
                updateTimeDisplay();
                updateOverlayDisplay(`ğŸ•“ ${formatTime(newTime)}`);
                localStorage.setItem('currentTime', newTime);
                showControlsAndFilename();
                updateIconOverlay();
            }
        });

        // æ¬¡ã®å‹•ç”»
        nextVideoBtn.addEventListener('click', () => {
            if (currentVideoIndex < playlist.length - 1) {
                currentVideoIndex++;
                localStorage.setItem('currentTime', 0);
                updatePlaylistDisplay();
                playVideo(playlist[currentVideoIndex].file);
                savePlaylistAndPlaybackState();
                showControlsAndFilename();
                updateIconOverlay();
            } else {
                videoPlayer.src = '';
                videoPreview.src = videoPlayer.src;
                savePlaylistAndPlaybackState();
                stopPeriodicSave();
                iconOverlay.classList.add('active');
            }
            showControlsAndFilename();
        });

        // ãƒŸãƒ¥ãƒ¼ãƒˆ/è§£é™¤
        volumeMuteBtn.addEventListener('click', () => {
            if (videoPlayer.volume === 0) {
                videoPlayer.volume = lastVolume || 0.2;
                volumeBar.value = videoPlayer.volume;
                volumeMuteBtn.textContent = 'ğŸ”Š';
                volumeMuteBtn.setAttribute('data-tooltip', 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
            } else {
                lastVolume = videoPlayer.volume;
                videoPlayer.volume = 0;
                volumeBar.value = 0;
                volumeMuteBtn.textContent = 'ğŸ”‡';
                volumeMuteBtn.setAttribute('data-tooltip', 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰');
            }
            updateVolumeDisplay();
            updateOverlayDisplay(`${videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š'} ${Math.round(videoPlayer.volume * 100)}%`);
            localStorage.setItem('volume', videoPlayer.volume);
            updateIconOverlay();
        });

        // ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³åˆ‡æ›¿
        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                if (mainContainer.requestFullscreen) {
                    mainContainer.requestFullscreen();
                    fullscreenBtn.textContent = 'âŒ';
                    fullscreenBtn.setAttribute('data-tooltip', 'ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è§£é™¤ï¼ˆCtrl+zï¼Double Clickï¼‰');
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    fullscreenBtn.textContent = 'ğŸ–¥ï¸';
                    fullscreenBtn.setAttribute('data-tooltip', 'ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºï¼ˆCtrl+zï¼Double Clickï¼‰');
                }
            }
            showControlsAndFilename();
            updateIconOverlay();
        });

        // æç”»ãƒ¢ãƒ¼ãƒ‰åˆ‡æ›¿
        fitModeBtn.addEventListener('click', () => {
            fitMode = fitMode === 'contain' ? 'cover' : 'contain';
            videoPlayer.style.objectFit = fitMode;
            fitModeBtn.textContent = fitMode === 'contain' ? 'â†”ï¸' : 'â†•ï¸';
            fitModeBtn.setAttribute('data-tooltip', fitMode === 'contain' ? 'æ¨ªã«åˆã‚ã›ã‚‹ï¼ˆCtrl+xï¼‰' : 'ç¸¦ã«åˆã‚ã›ã‚‹ï¼ˆCtrl+xï¼‰');
            localStorage.setItem('fitMode', fitMode);
            showControlsAndFilename();
            updateIconOverlay();
        });

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚µã‚¤ã‚ºå¤‰æ›´
        sizeSelect.addEventListener('change', () => {
            const value = parseInt(sizeSelect.value);
            localStorage.setItem('controlSize', value);
            updateControlSize(value);
            showControlsAndFilename();
            updateIconOverlay();
        });

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆé¸æŠ
        filenameDisplay.addEventListener('change', async () => {
            if (filename.style.opacity !== '1') return;
            const selectedIndex = parseInt(filenameDisplay.value);
            if (!isNaN(selectedIndex)) {
                // FFmpegå¤‰æ›ä¸­æ–­
                if (isConverting) {
                    await ipcRenderer.invoke('cancel-conversion');  // å³ä¸­æ–­
                    isConverting = false;
                    setTimeout(hideOverlayDisplay, 1000);
                }
                currentVideoIndex = selectedIndex;
                localStorage.setItem('currentTime', 0);
                playVideo(playlist[currentVideoIndex].file);
                savePlaylistAndPlaybackState();
                updateIconOverlay();
            }
        });

        // ãƒ˜ãƒ«ãƒ—ï¼ˆé–‹ãï¼‰ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        helpOpenBtn.addEventListener('click', openHelp);

        // ãƒ˜ãƒ«ãƒ—ï¼ˆé–‰ã˜ã‚‹ï¼‰ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼
        helpCloseBtn.addEventListener('click', closeHelp);

        // å‹•ç”»ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿
        videoPlayer.addEventListener('loadedmetadata', () => {
            seekBar.max = 100;
            updateTimeDisplay();
            updateVolumeDisplay();
            updateIconOverlay();
        });

        // å‹•ç”»ã‚¨ãƒ©ãƒ¼
        videoPlayer.addEventListener('error', () => {
            if (videoPlayer.src && /\.(mp4|mkv|webm)$/i.test(videoPlayer.src)) {
                stopPeriodicSave();
                playPauseBtn.textContent = 'â–¶ï¸';
                playPauseBtn.setAttribute('data-tooltip', 'å†ç”Ÿï¼ˆSpaceï¼Right Clickï¼‰');
                iconOverlay.classList.add('active');
            }
        });

        // å†ç”Ÿæ™‚é–“æ›´æ–°
        videoPlayer.addEventListener('timeupdate', () => {
            if (!isDragging && !seekBar.matches(':active') && !isMouseOverSeekBar) {
                const value = videoPlayer.duration ? (100 / videoPlayer.duration) * videoPlayer.currentTime : 0;
                seekBar.value = value;
                updateTimeDisplay();
                updateIconOverlay();
            }
        });

        // å‹•ç”»çµ‚äº†ï¼šBlob URL è§£æ”¾ + æ¬¡ã®å‹•ç”»ã¸
        videoPlayer.addEventListener('ended', async () => {
            // Blob URL è§£æ”¾
            if (playlist[currentVideoIndex]?.isConverted) {
                URL.revokeObjectURL(videoPlayer.src);
                playlist[currentVideoIndex].isConverted = false;
            }
        
            // ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤ï¼ˆéåŒæœŸï¼‰
            if (playlist[currentVideoIndex]?.tempFilePath) {
                try {
                    await fs.promises.unlink(playlist[currentVideoIndex].tempFilePath);
                    delete playlist[currentVideoIndex].tempFilePath;
                } catch (err) {
                    console.warn('ä¸€æ™‚ãƒ•ã‚¡ã‚¤ãƒ«å‰Šé™¤å¤±æ•—:', err);
                }
            }
            videoPlayer.currentTime = 0;
            localStorage.setItem('currentTime', 0);
        
            if (currentVideoIndex < playlist.length - 1) {
                currentVideoIndex++;
                updatePlaylistDisplay();
                playVideo(playlist[currentVideoIndex].file);
            } else {
                videoPlayer.pause();
                playPauseBtn.textContent = 'â–¶ï¸';
                videoPlayer.src = '';
                videoPreview.src = videoPlayer.src;
                videoPlayerActive = false;
        
                // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆã®å†ç”Ÿãƒãƒ¼ã‚¯ï¼ˆPlayï¼‰å‰Šé™¤
                const options = filenameDisplay.options;
                for (let i = 0; i < options.length; i++) {
                    options[i].text = options[i].text.replace(/^â–¶ï¸ /, '');
                }
        
                stopPeriodicSave();
                iconOverlay.classList.add('active');
                updateIconOverlay();
            }
        });

        // å‹•ç”»ã‚¯ãƒªãƒƒã‚¯
        videoPlayer.addEventListener('contextmenu', (event) => {
            event.preventDefault();
            if (event.ctrlKey) {
                playStopBtn.click();
            } else {
                togglePlayPause();
                showControlsAndFilename();
                updateIconOverlay();
            }
        });

        // å‹•ç”»ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯
        videoPlayer.addEventListener('dblclick', (event) => {
            event.preventDefault();
            if (!document.fullscreenElement) {
                if (mainContainer.requestFullscreen) {
                    mainContainer.requestFullscreen();
                    fullscreenBtn.textContent = 'âŒ';
                    fullscreenBtn.setAttribute('data-tooltip', 'ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è§£é™¤ï¼ˆCtrl+zï¼Double Clickï¼‰');
                }
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                    fullscreenBtn.textContent = 'ğŸ–¥ï¸';
                    fullscreenBtn.setAttribute('data-tooltip', 'ãƒ•ãƒ«ã‚¹ã‚¯ãƒªãƒ¼ãƒ³è¡¨ç¤ºï¼ˆCtrl+zï¼Double Clickï¼‰');
                }
            }
            showControlsAndFilename();
            updateIconOverlay();
        });

        // ãƒã‚¦ã‚¹æŠ¼ä¸‹
        videoPlayer.addEventListener('mousedown', (event) => {
            if (event.button === 0) {
                isDragging = true;
                dragStartX = event.clientX;
                dragStartY = event.clientY;
                wasPlaying = !videoPlayer.paused;
                event.preventDefault();
            }
        });

        // ãƒã‚¦ã‚¹ç§»å‹•
        videoPlayer.addEventListener('mousemove', (event) => {
            if (isDragging && videoPlayer.duration) {
                const deltaX = event.clientX - dragStartX;
                const deltaY = event.clientY - dragStartY;
                const absDeltaX = Math.abs(deltaX);
                const absDeltaY = Math.abs(deltaY);

                if (absDeltaX > absDeltaY && absDeltaX > 5) {
                    isVolumeDragging = false;
                    const seekStep = videoPlayer.duration / 1000;
                    const seekTime = deltaX * seekStep * seekSensitivity;
                    let newTime = videoPlayer.currentTime + seekTime;
                    newTime = Math.max(0, Math.min(videoPlayer.duration, newTime));
                    videoPlayer.currentTime = newTime;
                    seekBar.value = (100 / videoPlayer.duration) * newTime;
                    updateTimeDisplay();
                    updateOverlayDisplay(`ğŸ•“ ${formatTime(newTime)}`);
                    localStorage.setItem('currentTime', newTime);
                } else if (absDeltaY > absDeltaX && absDeltaY > 5) {
                    isVolumeDragging = true;
                    const newVolume = videoPlayer.volume - (deltaY * volumeStep);
                    videoPlayer.volume = Math.max(0, Math.min(1, newVolume));
                    volumeBar.value = videoPlayer.volume;
                    lastVolume = videoPlayer.volume;
                    volumeMuteBtn.textContent = videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š';
                    volumeMuteBtn.setAttribute('data-tooltip', videoPlayer.volume === 0 ? 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰' : 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
                    updateVolumeDisplay();
                    updateOverlayDisplay(`${videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š'} ${Math.round(videoPlayer.volume * 100)}%`);
                    localStorage.setItem('volume', videoPlayer.volume);
                }

                dragStartX = event.clientX;
                dragStartY = event.clientY;
                updateIconOverlay();
            }
        });
        
        // ãƒã‚¦ã‚¹è§£æ”¾
        videoPlayer.addEventListener('mouseup', (e) => {
            if (e.button === 0) {
                isDragging = false;
                isVolumeDragging = false;
                if (isDragging || isVolumeDragging) {
                    showControlsAndFilename();
                    updateIconOverlay();
                }
            }
        });

        // ãƒã‚¦ã‚¹ãƒªãƒ¼ãƒ–
        videoPlayer.addEventListener('mouseleave', () => {
            isDragging = false;
            isVolumeDragging = false;
            updateIconOverlay();
        });

        // ãƒã‚¦ã‚¹å·¦ã‚¯ãƒªãƒƒã‚¯ã§è¡¨ç¤º/éè¡¨ç¤ºã‚’ãƒˆã‚°ãƒ«
        videoPlayer.addEventListener('click', (e) => {
            if (e.button === 0) {
                if (!isDragging && !isVolumeDragging) {
                    if (controls.style.opacity === '1' || filename.style.opacity === '1') {
                        hideControlsAndFilename();
                    } else {
                        showControlsAndFilename();
                    }
                }
                e.stopPropagation();
            }
        });

        // ãƒã‚¦ã‚¹ãƒ›ã‚¤ãƒ¼ãƒ«
        videoPlayer.addEventListener('wheel', (event) => {
            event.preventDefault();
            const volumeStep = 0.01;
            if (event.deltaY < 0) {
                videoPlayer.volume = Math.min(1, videoPlayer.volume + volumeStep);
            } else if (event.deltaY > 0) {
                videoPlayer.volume = Math.max(0, videoPlayer.volume - volumeStep);
            }
            volumeBar.value = videoPlayer.volume;
            lastVolume = videoPlayer.volume;
            volumeMuteBtn.textContent = videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š';
            volumeMuteBtn.setAttribute('data-tooltip', videoPlayer.volume === 0 ? 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰' : 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
            updateVolumeDisplay();
            updateOverlayDisplay(`${videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š'} ${Math.round(videoPlayer.volume * 100)}%`);
            localStorage.setItem('volume', videoPlayer.volume);
            showControlsAndFilename();
            updateIconOverlay();
        });

        // ã‚·ãƒ¼ã‚¯ãƒãƒ¼ ãƒ‰ãƒ©ãƒƒã‚°
        seekBar.addEventListener('input', (e) => {
            if (controls.style.opacity !== '1') return;
            if (!videoPlayer.duration) return;
            const time = videoPlayer.duration * (seekBar.value / 100);
            videoPlayer.currentTime = time;
            updateTimeDisplay();
            updateOverlayDisplay(`ğŸ•“ ${formatTime(time)}`);
        });

        // ã‚·ãƒ¼ã‚¯ãƒãƒ¼ ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å¤‰æ›´
        seekBar.addEventListener('change', () => {
            if (controls.style.opacity !== '1') return;
            if (!videoPlayer.duration) return;
            // mouseup ã§æ—¢ã«å‡¦ç†æ¸ˆã¿ãªã®ã§ã€æœ€çµ‚åŒæœŸã®ã¿
            updateTimeDisplay();
            localStorage.setItem('currentTime', videoPlayer.currentTime);
        });

        // ã‚·ãƒ¼ã‚¯ãƒãƒ¼ ãƒã‚¦ã‚¹ã‚¯ãƒªãƒƒã‚¯
        seekBar.addEventListener('mousedown', (e) => {
            if (controls.style.opacity !== '1') return;
            if (e.button === 0 && videoPlayer.duration) {
                videoPlayer.currentTime = videoPreview.currentTime;
                isDragging = true;
                isSeekDragging = true;
                darkOverlay.style.display = 'block';
            }
        });

        // ã‚·ãƒ¼ã‚¯ãƒãƒ¼ ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼
        seekBar.addEventListener('mouseover', (e) => {
            if (controls.style.opacity !== '1') return;
            if (!videoPlayer.duration || playlist.length === 0) return;
            isMouseOverSeekBar = true;
            videoPreview.style.display = 'block';
            updatePreviewPosition(e);
        });

        // ã‚·ãƒ¼ã‚¯ãƒãƒ¼ ãƒã‚¦ã‚¹ç§»å‹•
        seekBar.addEventListener('mousemove', (e) => {
            if (controls.style.opacity !== '1') return;
            if (!videoPlayer.duration || !isMouseOverSeekBar) return;
            const rect = seekBar.getBoundingClientRect();
            const percent = Math.max(0, Math.min(1, (e.clientX - rect.left) / rect.width));
            const time = videoPlayer.duration * percent;

            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ™‚é–“æ›´æ–°
            if (Math.abs(videoPreview.currentTime - time) > 0.5) {
                videoPreview.currentTime = time;
            }

            // ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ä½ç½®æ›´æ–°
            updatePreviewPosition(e);

            // ã‚·ãƒ¼ã‚¯ãƒãƒ¼è¡¨ç¤ºæ›´æ–°ï¼ˆãƒ‰ãƒ©ãƒƒã‚°ä¸­ã¯ç„¡è¦–ï¼‰
            if (!isSeekDragging) {
                seekBar.value = percent * 100;
                timeDisplay.textContent = `${formatTime(time)} / ${formatTime(videoPlayer.duration)}`;
            }
        });

        // ã‚·ãƒ¼ã‚¯ãƒãƒ¼ ãƒã‚¦ã‚¹ã‚¢ã‚¦ãƒˆ
        seekBar.addEventListener('mouseout', () => {
            if (controls.style.opacity !== '1') return;
            isMouseOverSeekBar = false;
            videoPreview.style.display = 'none';
            // é€šå¸¸ã®æ™‚é–“è¡¨ç¤ºã«æˆ»ã™
            if (!isSeekDragging && videoPlayer.duration) {
                const value = (100 / videoPlayer.duration) * videoPlayer.currentTime;
                seekBar.value = value;
                updateTimeDisplay();
            }
        });
        
        // ã‚·ãƒ¼ã‚¯ãƒãƒ¼ ãƒã‚¦ã‚¹ãƒªãƒ¼ãƒ–
        seekBar.addEventListener('mouseleave', () => {
            if (controls.style.opacity !== '1') return;
            if (isSeekDragging && !seekBar.matches(':active')) {
                isSeekDragging = false;
                darkOverlay.style.display = 'none';
            }
        });

        // éŸ³é‡ãƒãƒ¼å…¥åŠ›
        volumeBar.addEventListener('input', () => {
            if (controls.style.opacity !== '1') return;
            videoPlayer.volume = volumeBar.value;
            lastVolume = videoPlayer.volume;
            volumeMuteBtn.textContent = videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š';
            volumeMuteBtn.setAttribute('data-tooltip', videoPlayer.volume === 0 ? 'ãƒŸãƒ¥ãƒ¼ãƒˆè§£é™¤ï¼ˆCtrl+mï¼‰' : 'ãƒŸãƒ¥ãƒ¼ãƒˆï¼ˆCtrl+mï¼‰');
            updateVolumeDisplay();
            updateOverlayDisplay(`${videoPlayer.volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š'} ${Math.round(videoPlayer.volume * 100)}%`);
            localStorage.setItem('volume', videoPlayer.volume);
            updateIconOverlay();
        });

        // éŸ³é‡ãƒãƒ¼ãƒã‚¦ã‚¹ç§»å‹•
        volumeBar.addEventListener('mousemove', (e) => {
            if (controls.style.opacity !== '1') return;
            if (volumeBar.matches(':active') || e.buttons === 1) {
                e.stopPropagation();
                const rect = volumeBar.getBoundingClientRect();
                const x = e.clientX - rect.left;
                if (x >= 0 && x <= rect.width) {
                    const volume = (x / rect.width);
                    const volumePercent = Math.round(volume * 100);
                    updateOverlayDisplay(`${volume === 0 ? 'ğŸ”‡' : 'ğŸ”Š'} ${volumePercent}%`);
                }
                showControlsAndFilename();
                updateIconOverlay();
            }
        });

        // éŸ³é‡ãƒãƒ¼ãƒã‚¦ã‚¹ãƒªãƒ¼ãƒ–
        volumeBar.addEventListener('mouseleave', () => {
            if (controls.style.opacity !== '1') return;
            if (!isDragging && !volumeBar.matches(':active')) {
                if (!isVolumeDragging && !volumeBar.matches(':active')) {
                    hideOverlayDisplay();
                }
                updateIconOverlay();
            }
        });

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼
        controls.addEventListener('mouseover', () => {
            if (controls.style.opacity === '1' || filename.style.opacity === '1') {
                isMouseOverControls = true;
                clearTimeout(timeout);
                controls.style.opacity = '1';
                filename.style.opacity = '1';
                videoContainer.style.cursor = 'auto';
                if (overlayDisplay.classList.contains('active')) {
                    overlayDisplay.style.display = 'block';
                    overlayDisplay.classList.add('active');
                }
                updateIconOverlay();
            }
        });

        // ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒã‚¦ã‚¹ãƒªãƒ¼ãƒ–
        controls.addEventListener('mouseleave', () => {
            if (controls.style.opacity === '1' || filename.style.opacity === '1') {
                isMouseOverControls = false;
                showControlsAndFilename();
                updateIconOverlay();
            }
        });

        // ãƒ•ã‚¡ã‚¤ãƒ«åãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼
        filename.addEventListener('mouseover', () => {
            if (controls.style.opacity === '1' || filename.style.opacity === '1') {
                isMouseOverControls = true;
                showControlsAndFilename();
                updateIconOverlay();
            }
        });

        // ãƒ•ã‚¡ã‚¤ãƒ«åãƒã‚¦ã‚¹ãƒªãƒ¼ãƒ–
        filename.addEventListener('mouseleave', () => {
            if (controls.style.opacity === '1' || filename.style.opacity === '1') {
                isMouseOverControls = false;
                showControlsAndFilename();
                updateIconOverlay();
            }
        });

        // å‹•ç”»ãƒã‚¦ã‚¹ç§»å‹•
        videoContainer.addEventListener('mousemove', () => {
            videoContainer.style.cursor = 'auto';
            updateIconOverlay();
        });

        // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—ã‚¤ãƒ™ãƒ³ãƒˆè¨­å®š
        tooltipElements.forEach(element => {
            element.addEventListener('mouseenter', () => showTooltip(element));
            element.addEventListener('mouseleave', () => hideTooltip(element));
        });

        // ä¸Šã¸ãƒœã‚¿ãƒ³
        upMovePlaylistBtn.addEventListener('click', () => {
            upMovePlaylist();
        });
        
        // ä¸‹ã¸ãƒœã‚¿ãƒ³
        downMovePlaylistBtn.addEventListener('click', () => {
            downMovePlaylist();
        });
        
        // è¿½åŠ ãƒœã‚¿ãƒ³
        addPlaylistBtn.addEventListener('click', () => {
            addToPlaylist();
        });
        
        // å‰Šé™¤ãƒœã‚¿ãƒ³
        removePlaylistBtn.addEventListener('click', () => {
            removeFromPlaylist();
        });
        
        // ã‚¯ãƒªã‚¢ãƒœã‚¿ãƒ³
        clearPlaylistBtn.addEventListener('click', () => {
            clearPlaylist();
        });        

        // ä¿å­˜ãƒœã‚¿ãƒ³
        savePlaylistBtn.addEventListener('click', () => {
            savePlaylist();
        });

        // ãƒ—ãƒ¬ã‚¤ãƒªã‚¹ãƒˆç·¨é›†ãƒ¡ãƒ‹ãƒ¥ãƒ¼
        filenameMenu.addEventListener('click', () => {
            if (filenameMenus.style.display === 'none') {
                filenameMenus.style.display = 'flex';
            } else {
                filenameMenus.style.display = 'none';
            }
        });
    </script>
</body>
</html>